

============================== 2022-10-06 14:25:03.138018 | 652187e3-daf2-4bef-8538-d1d893cce135 ==============================
[0m14:25:03.138031 [info ] [MainThread]: Running with dbt=1.2.2
[0m14:25:03.138453 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/okolesnikov/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'deps', 'rpc_method': 'deps', 'indirect_selection': 'eager'}
[0m14:25:03.138574 [debug] [MainThread]: Tracking: tracking
[0m14:25:03.181246 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff0855596a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff0855599a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff085568430>]}
[0m14:25:03.182796 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m14:25:03.183509 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff0855599a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff085568430>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff085568ac0>]}
[0m14:25:03.183831 [debug] [MainThread]: Flushing usage events


============================== 2022-10-06 14:30:49.843577 | 75261c57-6151-4713-ba2c-7c1e67412563 ==============================
[0m14:30:49.843589 [info ] [MainThread]: Running with dbt=1.2.2
[0m14:30:49.844701 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/okolesnikov/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'config_dir': True, 'which': 'debug', 'indirect_selection': 'eager'}
[0m14:30:49.844884 [debug] [MainThread]: Tracking: tracking
[0m14:30:49.875696 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd3eb56e670>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd3eb53b4f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd3eb53b730>]}
[0m14:30:49.877137 [info ] [MainThread]: To view your profiles.yml file, run:

open /Users/okolesnikov/.dbt
[0m14:30:49.877782 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd3eb53b730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd3eb515cd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd3eb515e80>]}
[0m14:30:49.878136 [debug] [MainThread]: Flushing usage events


============================== 2022-10-06 14:32:40.958687 | 57157579-68f8-497b-a6ef-466e352cfd9b ==============================
[0m14:32:40.958699 [info ] [MainThread]: Running with dbt=1.2.2
[0m14:32:40.959057 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/okolesnikov/Documents/health-union/Repos/DATA-3405-test', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'config_dir': True, 'which': 'debug', 'indirect_selection': 'eager'}
[0m14:32:40.959186 [debug] [MainThread]: Tracking: tracking
[0m14:32:40.979336 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc46a4bc5b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc46a4b3b50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc46a4b3280>]}
[0m14:32:40.980862 [info ] [MainThread]: To view your profiles.yml file, run:

open /Users/okolesnikov/Documents/health-union/Repos/DATA-3405-test
[0m14:32:40.981284 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc46a4b3280>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc46a4b3250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc46a4b3220>]}
[0m14:32:40.981588 [debug] [MainThread]: Flushing usage events


============================== 2022-10-06 14:33:04.371400 | 1f7effd8-e404-4dc5-bc1d-12171d64d9f4 ==============================
[0m14:33:04.371412 [info ] [MainThread]: Running with dbt=1.2.2
[0m14:33:04.371845 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/okolesnikov/Documents/health-union/Repos/DATA-3405-test/profiles.yml', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'config_dir': True, 'which': 'debug', 'indirect_selection': 'eager'}
[0m14:33:04.371989 [debug] [MainThread]: Tracking: tracking
[0m14:33:04.392626 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd41966e6d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd41963c0a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd41963cf40>]}
[0m14:33:04.394288 [info ] [MainThread]: To view your profiles.yml file, run:

open /Users/okolesnikov/Documents/health-union/Repos/DATA-3405-test/profiles.yml
[0m14:33:04.394811 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd41963cf40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd416104190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd4196334c0>]}
[0m14:33:04.395096 [debug] [MainThread]: Flushing usage events


============================== 2022-10-06 14:35:08.248770 | 79750c07-dda0-4c8f-affe-7aa1cbc2a485 ==============================
[0m14:35:08.248801 [info ] [MainThread]: Running with dbt=1.2.2
[0m14:35:08.249701 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/okolesnikov/Documents/health-union/Repos/DATA-3405-test', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'target': 'postgres', 'select': ['test_table_2'], 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m14:35:08.249911 [debug] [MainThread]: Tracking: tracking
[0m14:35:08.270166 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fedbf817970>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fedbf825f10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fedbf8278b0>]}
[0m14:35:08.287669 [info ] [MainThread]: Partial parse save file not found. Starting full parse.
[0m14:35:08.288029 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '79750c07-dda0-4c8f-affe-7aa1cbc2a485', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fedbf8163d0>]}
[0m14:35:08.330463 [debug] [MainThread]: Parsing macros/catalog.sql
[0m14:35:08.337767 [debug] [MainThread]: Parsing macros/relations.sql
[0m14:35:08.339296 [debug] [MainThread]: Parsing macros/adapters.sql
[0m14:35:08.367398 [debug] [MainThread]: Parsing macros/materializations/snapshot_merge.sql
[0m14:35:08.369303 [debug] [MainThread]: Parsing macros/utils/dateadd.sql
[0m14:35:08.370074 [debug] [MainThread]: Parsing macros/utils/listagg.sql
[0m14:35:08.371530 [debug] [MainThread]: Parsing macros/utils/datediff.sql
[0m14:35:08.378011 [debug] [MainThread]: Parsing macros/utils/any_value.sql
[0m14:35:08.378491 [debug] [MainThread]: Parsing macros/utils/last_day.sql
[0m14:35:08.379985 [debug] [MainThread]: Parsing macros/utils/split_part.sql
[0m14:35:08.381123 [debug] [MainThread]: Parsing macros/materializations/hooks.sql
[0m14:35:08.385054 [debug] [MainThread]: Parsing macros/materializations/configs.sql
[0m14:35:08.387652 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot_merge.sql
[0m14:35:08.389437 [debug] [MainThread]: Parsing macros/materializations/snapshots/strategies.sql
[0m14:35:08.405887 [debug] [MainThread]: Parsing macros/materializations/snapshots/helpers.sql
[0m14:35:08.418671 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot.sql
[0m14:35:08.430742 [debug] [MainThread]: Parsing macros/materializations/tests/test.sql
[0m14:35:08.435283 [debug] [MainThread]: Parsing macros/materializations/tests/helpers.sql
[0m14:35:08.437029 [debug] [MainThread]: Parsing macros/materializations/tests/where_subquery.sql
[0m14:35:08.438749 [debug] [MainThread]: Parsing macros/materializations/models/incremental/column_helpers.sql
[0m14:35:08.442862 [debug] [MainThread]: Parsing macros/materializations/models/incremental/merge.sql
[0m14:35:08.458900 [debug] [MainThread]: Parsing macros/materializations/models/incremental/is_incremental.sql
[0m14:35:08.460360 [debug] [MainThread]: Parsing macros/materializations/models/incremental/incremental.sql
[0m14:35:08.469370 [debug] [MainThread]: Parsing macros/materializations/models/incremental/on_schema_change.sql
[0m14:35:08.483472 [debug] [MainThread]: Parsing macros/materializations/models/table/table.sql
[0m14:35:08.488521 [debug] [MainThread]: Parsing macros/materializations/models/table/create_table_as.sql
[0m14:35:08.490980 [debug] [MainThread]: Parsing macros/materializations/models/view/view.sql
[0m14:35:08.495632 [debug] [MainThread]: Parsing macros/materializations/models/view/helpers.sql
[0m14:35:08.496728 [debug] [MainThread]: Parsing macros/materializations/models/view/create_or_replace_view.sql
[0m14:35:08.499834 [debug] [MainThread]: Parsing macros/materializations/models/view/create_view_as.sql
[0m14:35:08.501983 [debug] [MainThread]: Parsing macros/materializations/seeds/seed.sql
[0m14:35:08.508301 [debug] [MainThread]: Parsing macros/materializations/seeds/helpers.sql
[0m14:35:08.523543 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_alias.sql
[0m14:35:08.524843 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_schema.sql
[0m14:35:08.526994 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_database.sql
[0m14:35:08.528604 [debug] [MainThread]: Parsing macros/generic_test_sql/relationships.sql
[0m14:35:08.529375 [debug] [MainThread]: Parsing macros/generic_test_sql/not_null.sql
[0m14:35:08.530033 [debug] [MainThread]: Parsing macros/generic_test_sql/unique.sql
[0m14:35:08.530567 [debug] [MainThread]: Parsing macros/generic_test_sql/accepted_values.sql
[0m14:35:08.531678 [debug] [MainThread]: Parsing macros/etc/statement.sql
[0m14:35:08.535317 [debug] [MainThread]: Parsing macros/etc/datetime.sql
[0m14:35:08.542656 [debug] [MainThread]: Parsing macros/utils/except.sql
[0m14:35:08.543346 [debug] [MainThread]: Parsing macros/utils/replace.sql
[0m14:35:08.544511 [debug] [MainThread]: Parsing macros/utils/concat.sql
[0m14:35:08.545287 [debug] [MainThread]: Parsing macros/utils/length.sql
[0m14:35:08.546041 [debug] [MainThread]: Parsing macros/utils/dateadd.sql
[0m14:35:08.547024 [debug] [MainThread]: Parsing macros/utils/intersect.sql
[0m14:35:08.547683 [debug] [MainThread]: Parsing macros/utils/escape_single_quotes.sql
[0m14:35:08.548527 [debug] [MainThread]: Parsing macros/utils/right.sql
[0m14:35:08.549415 [debug] [MainThread]: Parsing macros/utils/listagg.sql
[0m14:35:08.552035 [debug] [MainThread]: Parsing macros/utils/datediff.sql
[0m14:35:08.553096 [debug] [MainThread]: Parsing macros/utils/safe_cast.sql
[0m14:35:08.554244 [debug] [MainThread]: Parsing macros/utils/hash.sql
[0m14:35:08.555168 [debug] [MainThread]: Parsing macros/utils/cast_bool_to_text.sql
[0m14:35:08.556001 [debug] [MainThread]: Parsing macros/utils/any_value.sql
[0m14:35:08.556724 [debug] [MainThread]: Parsing macros/utils/position.sql
[0m14:35:08.557766 [debug] [MainThread]: Parsing macros/utils/literal.sql
[0m14:35:08.558502 [debug] [MainThread]: Parsing macros/utils/data_types.sql
[0m14:35:08.593370 [debug] [MainThread]: Parsing macros/utils/bool_or.sql
[0m14:35:08.594329 [debug] [MainThread]: Parsing macros/utils/last_day.sql
[0m14:35:08.596062 [debug] [MainThread]: Parsing macros/utils/split_part.sql
[0m14:35:08.598529 [debug] [MainThread]: Parsing macros/utils/date_trunc.sql
[0m14:35:08.599708 [debug] [MainThread]: Parsing macros/adapters/schema.sql
[0m14:35:08.601805 [debug] [MainThread]: Parsing macros/adapters/indexes.sql
[0m14:35:08.604293 [debug] [MainThread]: Parsing macros/adapters/relation.sql
[0m14:35:08.620616 [debug] [MainThread]: Parsing macros/adapters/freshness.sql
[0m14:35:08.623475 [debug] [MainThread]: Parsing macros/adapters/apply_grants.sql
[0m14:35:08.637485 [debug] [MainThread]: Parsing macros/adapters/persist_docs.sql
[0m14:35:08.641949 [debug] [MainThread]: Parsing macros/adapters/metadata.sql
[0m14:35:08.648875 [debug] [MainThread]: Parsing macros/adapters/columns.sql
[0m14:35:08.658353 [debug] [MainThread]: Parsing tests/generic/builtin.sql
[0m14:35:08.883944 [debug] [MainThread]: 1699: static parser successfully parsed test_table_2.sql
[0m14:35:08.933847 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '79750c07-dda0-4c8f-affe-7aa1cbc2a485', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fedbf992fa0>]}
[0m14:35:08.939160 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '79750c07-dda0-4c8f-affe-7aa1cbc2a485', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fedbf816ca0>]}
[0m14:35:08.939570 [info ] [MainThread]: Found 1 model, 0 tests, 0 snapshots, 0 analyses, 256 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics
[0m14:35:08.939884 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '79750c07-dda0-4c8f-affe-7aa1cbc2a485', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fedbf963310>]}
[0m14:35:08.941014 [info ] [MainThread]: 
[0m14:35:08.941557 [debug] [MainThread]: Acquiring new postgres connection "master"
[0m14:35:08.942481 [debug] [ThreadPool]: Acquiring new postgres connection "list_defaultdb"
[0m14:35:08.953502 [debug] [ThreadPool]: Using postgres connection "list_defaultdb"
[0m14:35:08.953724 [debug] [ThreadPool]: On list_defaultdb: /* {"app": "dbt", "dbt_version": "1.2.2", "profile_name": "default", "target_name": "postgres", "connection_name": "list_defaultdb"} */

    select distinct nspname from pg_namespace
  
[0m14:35:08.953850 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:35:11.135816 [debug] [ThreadPool]: SQL status: SELECT 5 in 2.18 seconds
[0m14:35:11.140213 [debug] [ThreadPool]: On list_defaultdb: Close
[0m14:35:11.142834 [debug] [ThreadPool]: Acquiring new postgres connection "list_defaultdb_featuredata3405_scratch"
[0m14:35:11.154191 [debug] [ThreadPool]: Using postgres connection "list_defaultdb_featuredata3405_scratch"
[0m14:35:11.154502 [debug] [ThreadPool]: On list_defaultdb_featuredata3405_scratch: BEGIN
[0m14:35:11.154714 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:35:12.130872 [debug] [ThreadPool]: SQL status: BEGIN in 0.98 seconds
[0m14:35:12.131637 [debug] [ThreadPool]: Using postgres connection "list_defaultdb_featuredata3405_scratch"
[0m14:35:12.132143 [debug] [ThreadPool]: On list_defaultdb_featuredata3405_scratch: /* {"app": "dbt", "dbt_version": "1.2.2", "profile_name": "default", "target_name": "postgres", "connection_name": "list_defaultdb_featuredata3405_scratch"} */
select
      'defaultdb' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'featuredata3405_scratch'
    union all
    select
      'defaultdb' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'featuredata3405_scratch'
  
[0m14:35:12.258997 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.13 seconds
[0m14:35:12.262268 [debug] [ThreadPool]: On list_defaultdb_featuredata3405_scratch: ROLLBACK
[0m14:35:12.381989 [debug] [ThreadPool]: On list_defaultdb_featuredata3405_scratch: Close
[0m14:35:12.386274 [debug] [MainThread]: Using postgres connection "master"
[0m14:35:12.386600 [debug] [MainThread]: On master: BEGIN
[0m14:35:12.386834 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:35:13.460704 [debug] [MainThread]: SQL status: BEGIN in 1.07 seconds
[0m14:35:13.461221 [debug] [MainThread]: Using postgres connection "master"
[0m14:35:13.461583 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.2.2", "profile_name": "default", "target_name": "postgres", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m14:35:13.603711 [debug] [MainThread]: SQL status: SELECT 0 in 0.14 seconds
[0m14:35:13.607496 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '79750c07-dda0-4c8f-affe-7aa1cbc2a485', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fedbf96de20>]}
[0m14:35:13.608239 [debug] [MainThread]: On master: ROLLBACK
[0m14:35:13.745082 [debug] [MainThread]: Using postgres connection "master"
[0m14:35:13.745847 [debug] [MainThread]: On master: BEGIN
[0m14:35:14.016856 [debug] [MainThread]: SQL status: BEGIN in 0.27 seconds
[0m14:35:14.017683 [debug] [MainThread]: On master: COMMIT
[0m14:35:14.018225 [debug] [MainThread]: Using postgres connection "master"
[0m14:35:14.018670 [debug] [MainThread]: On master: COMMIT
[0m14:35:14.152711 [debug] [MainThread]: SQL status: COMMIT in 0.13 seconds
[0m14:35:14.153595 [debug] [MainThread]: On master: Close
[0m14:35:14.155594 [info ] [MainThread]: Concurrency: 4 threads (target='postgres')
[0m14:35:14.156749 [info ] [MainThread]: 
[0m14:35:14.164685 [debug] [Thread-1  ]: Began running node model.hu_dw_datawarehouse.test_table_2
[0m14:35:14.165306 [info ] [Thread-1  ]: 1 of 1 START view model featuredata3405_scratch.test_table_2 ................... [RUN]
[0m14:35:14.166430 [debug] [Thread-1  ]: Acquiring new postgres connection "model.hu_dw_datawarehouse.test_table_2"
[0m14:35:14.166865 [debug] [Thread-1  ]: Began compiling node model.hu_dw_datawarehouse.test_table_2
[0m14:35:14.167198 [debug] [Thread-1  ]: Compiling model.hu_dw_datawarehouse.test_table_2
[0m14:35:14.171570 [debug] [Thread-1  ]: Writing injected SQL for node "model.hu_dw_datawarehouse.test_table_2"
[0m14:35:14.173106 [debug] [Thread-1  ]: finished collecting timing info
[0m14:35:14.173546 [debug] [Thread-1  ]: Began executing node model.hu_dw_datawarehouse.test_table_2
[0m14:35:14.220234 [debug] [Thread-1  ]: Writing runtime SQL for node "model.hu_dw_datawarehouse.test_table_2"
[0m14:35:14.221001 [debug] [Thread-1  ]: Using postgres connection "model.hu_dw_datawarehouse.test_table_2"
[0m14:35:14.221231 [debug] [Thread-1  ]: On model.hu_dw_datawarehouse.test_table_2: BEGIN
[0m14:35:14.221345 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m14:35:15.182445 [debug] [Thread-1  ]: SQL status: BEGIN in 0.96 seconds
[0m14:35:15.183224 [debug] [Thread-1  ]: Using postgres connection "model.hu_dw_datawarehouse.test_table_2"
[0m14:35:15.183724 [debug] [Thread-1  ]: On model.hu_dw_datawarehouse.test_table_2: /* {"app": "dbt", "dbt_version": "1.2.2", "profile_name": "default", "target_name": "postgres", "node_id": "model.hu_dw_datawarehouse.test_table_2"} */

  create view "defaultdb"."featuredata3405_scratch"."test_table_2__dbt_tmp" as (
    SELECT col
, col*2 AS col_power_2
FROM
"defaultdb"."featuredata3405_scratch"."test_table_1"
  );
[0m14:35:15.313509 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.13 seconds
[0m14:35:15.326621 [debug] [Thread-1  ]: Using postgres connection "model.hu_dw_datawarehouse.test_table_2"
[0m14:35:15.326964 [debug] [Thread-1  ]: On model.hu_dw_datawarehouse.test_table_2: /* {"app": "dbt", "dbt_version": "1.2.2", "profile_name": "default", "target_name": "postgres", "node_id": "model.hu_dw_datawarehouse.test_table_2"} */
alter table "defaultdb"."featuredata3405_scratch"."test_table_2__dbt_tmp" rename to "test_table_2"
[0m14:35:15.445853 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.12 seconds
[0m14:35:15.477260 [debug] [Thread-1  ]: On model.hu_dw_datawarehouse.test_table_2: COMMIT
[0m14:35:15.477549 [debug] [Thread-1  ]: Using postgres connection "model.hu_dw_datawarehouse.test_table_2"
[0m14:35:15.477723 [debug] [Thread-1  ]: On model.hu_dw_datawarehouse.test_table_2: COMMIT
[0m14:35:15.596430 [debug] [Thread-1  ]: SQL status: COMMIT in 0.12 seconds
[0m14:35:15.610608 [debug] [Thread-1  ]: Using postgres connection "model.hu_dw_datawarehouse.test_table_2"
[0m14:35:15.611012 [debug] [Thread-1  ]: On model.hu_dw_datawarehouse.test_table_2: /* {"app": "dbt", "dbt_version": "1.2.2", "profile_name": "default", "target_name": "postgres", "node_id": "model.hu_dw_datawarehouse.test_table_2"} */
drop view if exists "defaultdb"."featuredata3405_scratch"."test_table_2__dbt_backup" cascade
[0m14:35:15.729959 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.12 seconds
[0m14:35:15.732688 [debug] [Thread-1  ]: finished collecting timing info
[0m14:35:15.733103 [debug] [Thread-1  ]: On model.hu_dw_datawarehouse.test_table_2: Close
[0m14:35:15.734232 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '79750c07-dda0-4c8f-affe-7aa1cbc2a485', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fedbfb37fa0>]}
[0m14:35:15.735042 [info ] [Thread-1  ]: 1 of 1 OK created view model featuredata3405_scratch.test_table_2 .............. [[32mCREATE VIEW[0m in 1.57s]
[0m14:35:15.735833 [debug] [Thread-1  ]: Finished running node model.hu_dw_datawarehouse.test_table_2
[0m14:35:15.738118 [debug] [MainThread]: Acquiring new postgres connection "master"
[0m14:35:15.738503 [debug] [MainThread]: Using postgres connection "master"
[0m14:35:15.738765 [debug] [MainThread]: On master: BEGIN
[0m14:35:15.738977 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:35:16.707044 [debug] [MainThread]: SQL status: BEGIN in 0.97 seconds
[0m14:35:16.707841 [debug] [MainThread]: On master: COMMIT
[0m14:35:16.708340 [debug] [MainThread]: Using postgres connection "master"
[0m14:35:16.708786 [debug] [MainThread]: On master: COMMIT
[0m14:35:16.827701 [debug] [MainThread]: SQL status: COMMIT in 0.12 seconds
[0m14:35:16.828500 [debug] [MainThread]: On master: Close
[0m14:35:16.829981 [info ] [MainThread]: 
[0m14:35:16.830611 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 7.89 seconds (7.89s).
[0m14:35:16.831193 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:35:16.831489 [debug] [MainThread]: Connection 'model.hu_dw_datawarehouse.test_table_2' was properly closed.
[0m14:35:16.842842 [info ] [MainThread]: 
[0m14:35:16.843341 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:35:16.843891 [info ] [MainThread]: 
[0m14:35:16.844353 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m14:35:16.844990 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fedbfc04f70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fedbfbffdc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fedbfbef7f0>]}
[0m14:35:16.845512 [debug] [MainThread]: Flushing usage events


============================== 2022-10-06 14:38:47.909591 | c7a5d628-3011-4f75-ad67-86ad99420640 ==============================
[0m14:38:47.909652 [info ] [MainThread]: Running with dbt=1.2.2
[0m14:38:47.911251 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/okolesnikov/Documents/health-union/Repos/DATA-3405-test', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'target': 'postgres', 'select': ['test_table_2'], 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m14:38:47.911611 [debug] [MainThread]: Tracking: tracking
[0m14:38:47.932886 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd22259f0d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd2225add30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd2225af8b0>]}
[0m14:38:48.002077 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m14:38:48.002526 [debug] [MainThread]: Partial parsing: updated file: hu_dw_datawarehouse://models/test_table_2.sql
[0m14:38:48.051890 [debug] [MainThread]: 1603: static parser failed on test_table_2.sql
[0m14:38:48.057571 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd22272dca0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd2225fb790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd2225fb550>]}
[0m14:38:48.057921 [debug] [MainThread]: Flushing usage events
[0m14:38:48.721861 [error] [MainThread]: Encountered an error:
Parsing Error in model test_table_2 (models/test_table_2.sql)
  at path ['materialized']: Undefined is not of type 'string'
[0m14:38:48.737469 [error] [MainThread]: jsonschema.exceptions.ValidationError: Undefined is not of type 'string'

Failed validating 'type' in schema['properties']['materialized']:
    {'default': 'view', 'type': 'string'}

On instance['materialized']:
    Undefined

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/okolesnikov/opt/anaconda3/lib/python3.9/site-packages/dbt/parser/base.py", line 342, in render_update
    self.update_parsed_node_config(node, config, context=context)
  File "/Users/okolesnikov/opt/anaconda3/lib/python3.9/site-packages/dbt/parser/base.py", line 276, in update_parsed_node_config
    config_dict = config.build_config_dict(patch_config_dict=patch_config_dict)
  File "/Users/okolesnikov/opt/anaconda3/lib/python3.9/site-packages/dbt/context/context_config.py", line 323, in build_config_dict
    return src.calculate_node_config_dict(
  File "/Users/okolesnikov/opt/anaconda3/lib/python3.9/site-packages/dbt/context/context_config.py", line 206, in calculate_node_config_dict
    finalized = config.finalize_and_validate()
  File "/Users/okolesnikov/opt/anaconda3/lib/python3.9/site-packages/dbt/contracts/graph/model_config.py", line 352, in finalize_and_validate
    self.validate(dct)
  File "/Users/okolesnikov/opt/anaconda3/lib/python3.9/site-packages/hologram/__init__.py", line 989, in validate
    raise ValidationError.create_from(error) from error
hologram.ValidationError: Undefined is not of type 'string'

Failed validating 'type' in schema['properties']['materialized']:
    {'default': 'view', 'type': 'string'}

On instance['materialized']:
    Undefined

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/okolesnikov/opt/anaconda3/lib/python3.9/site-packages/dbt/main.py", line 129, in main
    results, succeeded = handle_and_check(args)
  File "/Users/okolesnikov/opt/anaconda3/lib/python3.9/site-packages/dbt/main.py", line 191, in handle_and_check
    task, res = run_from_args(parsed)
  File "/Users/okolesnikov/opt/anaconda3/lib/python3.9/site-packages/dbt/main.py", line 238, in run_from_args
    results = task.run()
  File "/Users/okolesnikov/opt/anaconda3/lib/python3.9/site-packages/dbt/task/runnable.py", line 451, in run
    self._runtime_initialize()
  File "/Users/okolesnikov/opt/anaconda3/lib/python3.9/site-packages/dbt/task/runnable.py", line 159, in _runtime_initialize
    super()._runtime_initialize()
  File "/Users/okolesnikov/opt/anaconda3/lib/python3.9/site-packages/dbt/task/runnable.py", line 92, in _runtime_initialize
    self.load_manifest()
  File "/Users/okolesnikov/opt/anaconda3/lib/python3.9/site-packages/dbt/task/runnable.py", line 81, in load_manifest
    self.manifest = ManifestLoader.get_full_manifest(self.config)
  File "/Users/okolesnikov/opt/anaconda3/lib/python3.9/site-packages/dbt/parser/manifest.py", line 219, in get_full_manifest
    manifest = loader.load()
  File "/Users/okolesnikov/opt/anaconda3/lib/python3.9/site-packages/dbt/parser/manifest.py", line 349, in load
    self.parse_project(
  File "/Users/okolesnikov/opt/anaconda3/lib/python3.9/site-packages/dbt/parser/manifest.py", line 473, in parse_project
    parser.parse_file(block)
  File "/Users/okolesnikov/opt/anaconda3/lib/python3.9/site-packages/dbt/parser/base.py", line 392, in parse_file
    self.parse_node(file_block)
  File "/Users/okolesnikov/opt/anaconda3/lib/python3.9/site-packages/dbt/parser/base.py", line 366, in parse_node
    self.render_update(node, config)
  File "/Users/okolesnikov/opt/anaconda3/lib/python3.9/site-packages/dbt/parser/models.py", line 147, in render_update
    super().render_update(node, config)
  File "/Users/okolesnikov/opt/anaconda3/lib/python3.9/site-packages/dbt/parser/base.py", line 346, in render_update
    raise ParsingException(msg, node=node) from exc
dbt.exceptions.ParsingException: Parsing Error in model test_table_2 (models/test_table_2.sql)
  at path ['materialized']: Undefined is not of type 'string'



============================== 2022-10-06 14:39:14.644474 | e1978f73-34c2-4103-86a6-25c31e5edae0 ==============================
[0m14:39:14.644507 [info ] [MainThread]: Running with dbt=1.2.2
[0m14:39:14.645488 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/okolesnikov/Documents/health-union/Repos/DATA-3405-test', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'target': 'postgres', 'select': ['test_table_2'], 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m14:39:14.645734 [debug] [MainThread]: Tracking: tracking
[0m14:39:14.669409 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8b71717700>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8b71723e80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8b717279a0>]}
[0m14:39:14.711178 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m14:39:14.711758 [debug] [MainThread]: Partial parsing: updated file: hu_dw_datawarehouse://models/test_table_2.sql
[0m14:39:14.752924 [debug] [MainThread]: 1603: static parser failed on test_table_2.sql
[0m14:39:14.766350 [debug] [MainThread]: 1602: parser fallback to jinja rendering on test_table_2.sql
[0m14:39:14.775222 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e1978f73-34c2-4103-86a6-25c31e5edae0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8b717b40d0>]}
[0m14:39:14.780732 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e1978f73-34c2-4103-86a6-25c31e5edae0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8b7166f670>]}
[0m14:39:14.781326 [info ] [MainThread]: Found 1 model, 0 tests, 0 snapshots, 0 analyses, 256 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics
[0m14:39:14.781598 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e1978f73-34c2-4103-86a6-25c31e5edae0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8b7189bd00>]}
[0m14:39:14.782821 [info ] [MainThread]: 
[0m14:39:14.783424 [debug] [MainThread]: Acquiring new postgres connection "master"
[0m14:39:14.784422 [debug] [ThreadPool]: Acquiring new postgres connection "list_defaultdb"
[0m14:39:14.795857 [debug] [ThreadPool]: Using postgres connection "list_defaultdb"
[0m14:39:14.796089 [debug] [ThreadPool]: On list_defaultdb: /* {"app": "dbt", "dbt_version": "1.2.2", "profile_name": "default", "target_name": "postgres", "connection_name": "list_defaultdb"} */

    select distinct nspname from pg_namespace
  
[0m14:39:14.796220 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:39:15.921792 [debug] [ThreadPool]: SQL status: SELECT 5 in 1.13 seconds
[0m14:39:15.926451 [debug] [ThreadPool]: On list_defaultdb: Close
[0m14:39:15.929227 [debug] [ThreadPool]: Acquiring new postgres connection "list_defaultdb_featuredata3405_scratch"
[0m14:39:15.941274 [debug] [ThreadPool]: Using postgres connection "list_defaultdb_featuredata3405_scratch"
[0m14:39:15.941643 [debug] [ThreadPool]: On list_defaultdb_featuredata3405_scratch: BEGIN
[0m14:39:15.941898 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:39:16.907656 [debug] [ThreadPool]: SQL status: BEGIN in 0.97 seconds
[0m14:39:16.908403 [debug] [ThreadPool]: Using postgres connection "list_defaultdb_featuredata3405_scratch"
[0m14:39:16.908880 [debug] [ThreadPool]: On list_defaultdb_featuredata3405_scratch: /* {"app": "dbt", "dbt_version": "1.2.2", "profile_name": "default", "target_name": "postgres", "connection_name": "list_defaultdb_featuredata3405_scratch"} */
select
      'defaultdb' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'featuredata3405_scratch'
    union all
    select
      'defaultdb' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'featuredata3405_scratch'
  
[0m14:39:17.032378 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.12 seconds
[0m14:39:17.036239 [debug] [ThreadPool]: On list_defaultdb_featuredata3405_scratch: ROLLBACK
[0m14:39:17.154422 [debug] [ThreadPool]: On list_defaultdb_featuredata3405_scratch: Close
[0m14:39:17.160602 [debug] [MainThread]: Using postgres connection "master"
[0m14:39:17.160821 [debug] [MainThread]: On master: BEGIN
[0m14:39:17.160939 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:39:18.124206 [debug] [MainThread]: SQL status: BEGIN in 0.96 seconds
[0m14:39:18.124996 [debug] [MainThread]: Using postgres connection "master"
[0m14:39:18.125480 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.2.2", "profile_name": "default", "target_name": "postgres", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m14:39:18.260443 [debug] [MainThread]: SQL status: SELECT 1 in 0.13 seconds
[0m14:39:18.263358 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e1978f73-34c2-4103-86a6-25c31e5edae0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8b717737f0>]}
[0m14:39:18.264293 [debug] [MainThread]: On master: ROLLBACK
[0m14:39:18.383521 [debug] [MainThread]: Using postgres connection "master"
[0m14:39:18.384343 [debug] [MainThread]: On master: BEGIN
[0m14:39:18.622907 [debug] [MainThread]: SQL status: BEGIN in 0.24 seconds
[0m14:39:18.623430 [debug] [MainThread]: On master: COMMIT
[0m14:39:18.623747 [debug] [MainThread]: Using postgres connection "master"
[0m14:39:18.624006 [debug] [MainThread]: On master: COMMIT
[0m14:39:18.742642 [debug] [MainThread]: SQL status: COMMIT in 0.12 seconds
[0m14:39:18.743601 [debug] [MainThread]: On master: Close
[0m14:39:18.745280 [info ] [MainThread]: Concurrency: 4 threads (target='postgres')
[0m14:39:18.746042 [info ] [MainThread]: 
[0m14:39:18.753200 [debug] [Thread-1  ]: Began running node model.hu_dw_datawarehouse.test_table_2
[0m14:39:18.753832 [info ] [Thread-1  ]: 1 of 1 START table model featuredata3405_scratch.test_table_2 .................. [RUN]
[0m14:39:18.754767 [debug] [Thread-1  ]: Acquiring new postgres connection "model.hu_dw_datawarehouse.test_table_2"
[0m14:39:18.755110 [debug] [Thread-1  ]: Began compiling node model.hu_dw_datawarehouse.test_table_2
[0m14:39:18.755421 [debug] [Thread-1  ]: Compiling model.hu_dw_datawarehouse.test_table_2
[0m14:39:18.761210 [debug] [Thread-1  ]: Writing injected SQL for node "model.hu_dw_datawarehouse.test_table_2"
[0m14:39:18.762240 [debug] [Thread-1  ]: finished collecting timing info
[0m14:39:18.762659 [debug] [Thread-1  ]: Began executing node model.hu_dw_datawarehouse.test_table_2
[0m14:39:18.811072 [debug] [Thread-1  ]: Writing runtime SQL for node "model.hu_dw_datawarehouse.test_table_2"
[0m14:39:18.811820 [debug] [Thread-1  ]: Using postgres connection "model.hu_dw_datawarehouse.test_table_2"
[0m14:39:18.812052 [debug] [Thread-1  ]: On model.hu_dw_datawarehouse.test_table_2: BEGIN
[0m14:39:18.812205 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m14:39:19.776886 [debug] [Thread-1  ]: SQL status: BEGIN in 0.96 seconds
[0m14:39:19.777666 [debug] [Thread-1  ]: Using postgres connection "model.hu_dw_datawarehouse.test_table_2"
[0m14:39:19.778164 [debug] [Thread-1  ]: On model.hu_dw_datawarehouse.test_table_2: /* {"app": "dbt", "dbt_version": "1.2.2", "profile_name": "default", "target_name": "postgres", "node_id": "model.hu_dw_datawarehouse.test_table_2"} */


  create  table "defaultdb"."featuredata3405_scratch"."test_table_2__dbt_tmp"
  as (
    

SELECT col
, col*2 AS col_power_2
FROM
"defaultdb"."featuredata3405_scratch"."test_table_1"
  );
[0m14:39:19.901622 [debug] [Thread-1  ]: SQL status: SELECT 5 in 0.12 seconds
[0m14:39:19.916284 [debug] [Thread-1  ]: Using postgres connection "model.hu_dw_datawarehouse.test_table_2"
[0m14:39:19.916649 [debug] [Thread-1  ]: On model.hu_dw_datawarehouse.test_table_2: /* {"app": "dbt", "dbt_version": "1.2.2", "profile_name": "default", "target_name": "postgres", "node_id": "model.hu_dw_datawarehouse.test_table_2"} */
alter table "defaultdb"."featuredata3405_scratch"."test_table_2" rename to "test_table_2__dbt_backup"
[0m14:39:20.036481 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.12 seconds
[0m14:39:20.043487 [debug] [Thread-1  ]: Using postgres connection "model.hu_dw_datawarehouse.test_table_2"
[0m14:39:20.043886 [debug] [Thread-1  ]: On model.hu_dw_datawarehouse.test_table_2: /* {"app": "dbt", "dbt_version": "1.2.2", "profile_name": "default", "target_name": "postgres", "node_id": "model.hu_dw_datawarehouse.test_table_2"} */
alter table "defaultdb"."featuredata3405_scratch"."test_table_2__dbt_tmp" rename to "test_table_2"
[0m14:39:20.163109 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.12 seconds
[0m14:39:20.201398 [debug] [Thread-1  ]: On model.hu_dw_datawarehouse.test_table_2: COMMIT
[0m14:39:20.201627 [debug] [Thread-1  ]: Using postgres connection "model.hu_dw_datawarehouse.test_table_2"
[0m14:39:20.201763 [debug] [Thread-1  ]: On model.hu_dw_datawarehouse.test_table_2: COMMIT
[0m14:39:20.321301 [debug] [Thread-1  ]: SQL status: COMMIT in 0.12 seconds
[0m14:39:20.333985 [debug] [Thread-1  ]: Using postgres connection "model.hu_dw_datawarehouse.test_table_2"
[0m14:39:20.334365 [debug] [Thread-1  ]: On model.hu_dw_datawarehouse.test_table_2: /* {"app": "dbt", "dbt_version": "1.2.2", "profile_name": "default", "target_name": "postgres", "node_id": "model.hu_dw_datawarehouse.test_table_2"} */
drop view if exists "defaultdb"."featuredata3405_scratch"."test_table_2__dbt_backup" cascade
[0m14:39:20.456151 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.12 seconds
[0m14:39:20.460060 [debug] [Thread-1  ]: finished collecting timing info
[0m14:39:20.460513 [debug] [Thread-1  ]: On model.hu_dw_datawarehouse.test_table_2: Close
[0m14:39:20.461684 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e1978f73-34c2-4103-86a6-25c31e5edae0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8b7189bd00>]}
[0m14:39:20.462475 [info ] [Thread-1  ]: 1 of 1 OK created table model featuredata3405_scratch.test_table_2 ............. [[32mSELECT 5[0m in 1.71s]
[0m14:39:20.463389 [debug] [Thread-1  ]: Finished running node model.hu_dw_datawarehouse.test_table_2
[0m14:39:20.465995 [debug] [MainThread]: Acquiring new postgres connection "master"
[0m14:39:20.466468 [debug] [MainThread]: Using postgres connection "master"
[0m14:39:20.466739 [debug] [MainThread]: On master: BEGIN
[0m14:39:20.466971 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:39:21.471725 [debug] [MainThread]: SQL status: BEGIN in 1.0 seconds
[0m14:39:21.472492 [debug] [MainThread]: On master: COMMIT
[0m14:39:21.473009 [debug] [MainThread]: Using postgres connection "master"
[0m14:39:21.473456 [debug] [MainThread]: On master: COMMIT
[0m14:39:21.594790 [debug] [MainThread]: SQL status: COMMIT in 0.12 seconds
[0m14:39:21.595619 [debug] [MainThread]: On master: Close
[0m14:39:21.597327 [info ] [MainThread]: 
[0m14:39:21.598351 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 6.81 seconds (6.81s).
[0m14:39:21.599074 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:39:21.599403 [debug] [MainThread]: Connection 'model.hu_dw_datawarehouse.test_table_2' was properly closed.
[0m14:39:21.613331 [info ] [MainThread]: 
[0m14:39:21.613961 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:39:21.614864 [info ] [MainThread]: 
[0m14:39:21.615602 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m14:39:21.616340 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8b7163c850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8b71725f70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8b71ae8c70>]}
[0m14:39:21.616876 [debug] [MainThread]: Flushing usage events


============================== 2022-10-06 14:41:16.301664 | 41324715-da92-4e51-844d-0c9419112760 ==============================
[0m14:41:16.301745 [info ] [MainThread]: Running with dbt=1.2.2
[0m14:41:16.302976 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/okolesnikov/Documents/health-union/Repos/DATA-3405-test', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m14:41:16.303850 [debug] [MainThread]: Tracking: tracking
[0m14:41:16.366128 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffb7a6ae670>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffb7a6ac520>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffb7a69a2b0>]}
[0m14:41:16.431428 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m14:41:16.431850 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '41324715-da92-4e51-844d-0c9419112760', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffb7a5bc9a0>]}
[0m14:41:16.504338 [debug] [MainThread]: Parsing macros/catalog.sql
[0m14:41:16.508878 [debug] [MainThread]: Parsing macros/relations.sql
[0m14:41:16.510469 [debug] [MainThread]: Parsing macros/adapters.sql
[0m14:41:16.548695 [debug] [MainThread]: Parsing macros/materializations/snapshot_merge.sql
[0m14:41:16.552015 [debug] [MainThread]: Parsing macros/utils/dateadd.sql
[0m14:41:16.553068 [debug] [MainThread]: Parsing macros/utils/listagg.sql
[0m14:41:16.555257 [debug] [MainThread]: Parsing macros/utils/datediff.sql
[0m14:41:16.564248 [debug] [MainThread]: Parsing macros/utils/any_value.sql
[0m14:41:16.564999 [debug] [MainThread]: Parsing macros/utils/last_day.sql
[0m14:41:16.566968 [debug] [MainThread]: Parsing macros/utils/split_part.sql
[0m14:41:16.569108 [debug] [MainThread]: Parsing macros/materializations/hooks.sql
[0m14:41:16.574973 [debug] [MainThread]: Parsing macros/materializations/configs.sql
[0m14:41:16.578542 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot_merge.sql
[0m14:41:16.581025 [debug] [MainThread]: Parsing macros/materializations/snapshots/strategies.sql
[0m14:41:16.668021 [debug] [MainThread]: Parsing macros/materializations/snapshots/helpers.sql
[0m14:41:16.685617 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot.sql
[0m14:41:16.702202 [debug] [MainThread]: Parsing macros/materializations/tests/test.sql
[0m14:41:16.707085 [debug] [MainThread]: Parsing macros/materializations/tests/helpers.sql
[0m14:41:16.709101 [debug] [MainThread]: Parsing macros/materializations/tests/where_subquery.sql
[0m14:41:16.713449 [debug] [MainThread]: Parsing macros/materializations/models/incremental/column_helpers.sql
[0m14:41:16.718451 [debug] [MainThread]: Parsing macros/materializations/models/incremental/merge.sql
[0m14:41:16.738360 [debug] [MainThread]: Parsing macros/materializations/models/incremental/is_incremental.sql
[0m14:41:16.740092 [debug] [MainThread]: Parsing macros/materializations/models/incremental/incremental.sql
[0m14:41:16.752717 [debug] [MainThread]: Parsing macros/materializations/models/incremental/on_schema_change.sql
[0m14:41:16.771467 [debug] [MainThread]: Parsing macros/materializations/models/table/table.sql
[0m14:41:16.778612 [debug] [MainThread]: Parsing macros/materializations/models/table/create_table_as.sql
[0m14:41:16.783635 [debug] [MainThread]: Parsing macros/materializations/models/view/view.sql
[0m14:41:16.790415 [debug] [MainThread]: Parsing macros/materializations/models/view/helpers.sql
[0m14:41:16.792107 [debug] [MainThread]: Parsing macros/materializations/models/view/create_or_replace_view.sql
[0m14:41:16.797063 [debug] [MainThread]: Parsing macros/materializations/models/view/create_view_as.sql
[0m14:41:16.800860 [debug] [MainThread]: Parsing macros/materializations/seeds/seed.sql
[0m14:41:16.809334 [debug] [MainThread]: Parsing macros/materializations/seeds/helpers.sql
[0m14:41:16.833674 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_alias.sql
[0m14:41:16.835623 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_schema.sql
[0m14:41:16.838617 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_database.sql
[0m14:41:16.841080 [debug] [MainThread]: Parsing macros/generic_test_sql/relationships.sql
[0m14:41:16.842188 [debug] [MainThread]: Parsing macros/generic_test_sql/not_null.sql
[0m14:41:16.843220 [debug] [MainThread]: Parsing macros/generic_test_sql/unique.sql
[0m14:41:16.844104 [debug] [MainThread]: Parsing macros/generic_test_sql/accepted_values.sql
[0m14:41:16.846252 [debug] [MainThread]: Parsing macros/etc/statement.sql
[0m14:41:16.852632 [debug] [MainThread]: Parsing macros/etc/datetime.sql
[0m14:41:16.863602 [debug] [MainThread]: Parsing macros/utils/except.sql
[0m14:41:16.864718 [debug] [MainThread]: Parsing macros/utils/replace.sql
[0m14:41:16.866177 [debug] [MainThread]: Parsing macros/utils/concat.sql
[0m14:41:16.867717 [debug] [MainThread]: Parsing macros/utils/length.sql
[0m14:41:16.869011 [debug] [MainThread]: Parsing macros/utils/dateadd.sql
[0m14:41:16.870443 [debug] [MainThread]: Parsing macros/utils/intersect.sql
[0m14:41:16.871384 [debug] [MainThread]: Parsing macros/utils/escape_single_quotes.sql
[0m14:41:16.872641 [debug] [MainThread]: Parsing macros/utils/right.sql
[0m14:41:16.873967 [debug] [MainThread]: Parsing macros/utils/listagg.sql
[0m14:41:16.876794 [debug] [MainThread]: Parsing macros/utils/datediff.sql
[0m14:41:16.878379 [debug] [MainThread]: Parsing macros/utils/safe_cast.sql
[0m14:41:16.879680 [debug] [MainThread]: Parsing macros/utils/hash.sql
[0m14:41:16.881013 [debug] [MainThread]: Parsing macros/utils/cast_bool_to_text.sql
[0m14:41:16.882548 [debug] [MainThread]: Parsing macros/utils/any_value.sql
[0m14:41:16.883678 [debug] [MainThread]: Parsing macros/utils/position.sql
[0m14:41:16.884972 [debug] [MainThread]: Parsing macros/utils/literal.sql
[0m14:41:16.886202 [debug] [MainThread]: Parsing macros/utils/data_types.sql
[0m14:41:16.892363 [debug] [MainThread]: Parsing macros/utils/bool_or.sql
[0m14:41:16.893917 [debug] [MainThread]: Parsing macros/utils/last_day.sql
[0m14:41:16.896533 [debug] [MainThread]: Parsing macros/utils/split_part.sql
[0m14:41:16.899233 [debug] [MainThread]: Parsing macros/utils/date_trunc.sql
[0m14:41:16.900672 [debug] [MainThread]: Parsing macros/adapters/schema.sql
[0m14:41:16.903342 [debug] [MainThread]: Parsing macros/adapters/indexes.sql
[0m14:41:16.906821 [debug] [MainThread]: Parsing macros/adapters/relation.sql
[0m14:41:16.923417 [debug] [MainThread]: Parsing macros/adapters/freshness.sql
[0m14:41:16.926923 [debug] [MainThread]: Parsing macros/adapters/apply_grants.sql
[0m14:41:16.942805 [debug] [MainThread]: Parsing macros/adapters/persist_docs.sql
[0m14:41:16.948105 [debug] [MainThread]: Parsing macros/adapters/metadata.sql
[0m14:41:16.955842 [debug] [MainThread]: Parsing macros/adapters/columns.sql
[0m14:41:16.967040 [debug] [MainThread]: Parsing tests/generic/builtin.sql
[0m14:41:17.252913 [debug] [MainThread]: 1603: static parser failed on test_table_2.sql
[0m14:41:17.267509 [debug] [MainThread]: 1602: parser fallback to jinja rendering on test_table_2.sql
[0m14:41:17.314089 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '41324715-da92-4e51-844d-0c9419112760', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffb7a7e34c0>]}
[0m14:41:17.319941 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '41324715-da92-4e51-844d-0c9419112760', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffb7a6aeaf0>]}
[0m14:41:17.320339 [info ] [MainThread]: Found 1 model, 0 tests, 0 snapshots, 0 analyses, 256 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics
[0m14:41:17.320666 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '41324715-da92-4e51-844d-0c9419112760', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffb7a856af0>]}
[0m14:41:17.322081 [info ] [MainThread]: 
[0m14:41:17.322708 [debug] [MainThread]: Acquiring new postgres connection "master"
[0m14:41:17.324040 [debug] [ThreadPool]: Acquiring new postgres connection "list_defaultdb"
[0m14:41:17.340646 [debug] [ThreadPool]: Using postgres connection "list_defaultdb"
[0m14:41:17.340889 [debug] [ThreadPool]: On list_defaultdb: /* {"app": "dbt", "dbt_version": "1.2.2", "profile_name": "default", "target_name": "postgres", "connection_name": "list_defaultdb"} */

    select distinct nspname from pg_namespace
  
[0m14:41:17.341056 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:41:18.450414 [debug] [ThreadPool]: SQL status: SELECT 5 in 1.11 seconds
[0m14:41:18.451797 [debug] [ThreadPool]: On list_defaultdb: Close
[0m14:41:18.453032 [debug] [ThreadPool]: Acquiring new postgres connection "list_defaultdb_featuredata3405_scratch"
[0m14:41:18.459407 [debug] [ThreadPool]: Using postgres connection "list_defaultdb_featuredata3405_scratch"
[0m14:41:18.459639 [debug] [ThreadPool]: On list_defaultdb_featuredata3405_scratch: BEGIN
[0m14:41:18.459767 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:41:19.419116 [debug] [ThreadPool]: SQL status: BEGIN in 0.96 seconds
[0m14:41:19.419361 [debug] [ThreadPool]: Using postgres connection "list_defaultdb_featuredata3405_scratch"
[0m14:41:19.419496 [debug] [ThreadPool]: On list_defaultdb_featuredata3405_scratch: /* {"app": "dbt", "dbt_version": "1.2.2", "profile_name": "default", "target_name": "postgres", "connection_name": "list_defaultdb_featuredata3405_scratch"} */
select
      'defaultdb' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'featuredata3405_scratch'
    union all
    select
      'defaultdb' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'featuredata3405_scratch'
  
[0m14:41:19.542314 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.12 seconds
[0m14:41:19.543606 [debug] [ThreadPool]: On list_defaultdb_featuredata3405_scratch: ROLLBACK
[0m14:41:19.661956 [debug] [ThreadPool]: On list_defaultdb_featuredata3405_scratch: Close
[0m14:41:19.666623 [debug] [MainThread]: Using postgres connection "master"
[0m14:41:19.666857 [debug] [MainThread]: On master: BEGIN
[0m14:41:19.666992 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:41:20.630802 [debug] [MainThread]: SQL status: BEGIN in 0.96 seconds
[0m14:41:20.631040 [debug] [MainThread]: Using postgres connection "master"
[0m14:41:20.631183 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.2.2", "profile_name": "default", "target_name": "postgres", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m14:41:20.754063 [debug] [MainThread]: SQL status: SELECT 0 in 0.12 seconds
[0m14:41:20.755180 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '41324715-da92-4e51-844d-0c9419112760', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffb7a7e3310>]}
[0m14:41:20.755555 [debug] [MainThread]: On master: ROLLBACK
[0m14:41:20.873628 [debug] [MainThread]: Using postgres connection "master"
[0m14:41:20.873868 [debug] [MainThread]: On master: BEGIN
[0m14:41:21.115620 [debug] [MainThread]: SQL status: BEGIN in 0.24 seconds
[0m14:41:21.115894 [debug] [MainThread]: On master: COMMIT
[0m14:41:21.116040 [debug] [MainThread]: Using postgres connection "master"
[0m14:41:21.116164 [debug] [MainThread]: On master: COMMIT
[0m14:41:21.241618 [debug] [MainThread]: SQL status: COMMIT in 0.13 seconds
[0m14:41:21.241887 [debug] [MainThread]: On master: Close
[0m14:41:21.242390 [info ] [MainThread]: Concurrency: 4 threads (target='postgres')
[0m14:41:21.242669 [info ] [MainThread]: 
[0m14:41:21.246185 [debug] [Thread-1  ]: Began running node model.hu_dw_datawarehouse.test_table_2
[0m14:41:21.246556 [info ] [Thread-1  ]: 1 of 1 START table model featuredata3405_scratch.test_table_2 .................. [RUN]
[0m14:41:21.247101 [debug] [Thread-1  ]: Acquiring new postgres connection "model.hu_dw_datawarehouse.test_table_2"
[0m14:41:21.247337 [debug] [Thread-1  ]: Began compiling node model.hu_dw_datawarehouse.test_table_2
[0m14:41:21.247516 [debug] [Thread-1  ]: Compiling model.hu_dw_datawarehouse.test_table_2
[0m14:41:21.250647 [debug] [Thread-1  ]: Writing injected SQL for node "model.hu_dw_datawarehouse.test_table_2"
[0m14:41:21.251300 [debug] [Thread-1  ]: finished collecting timing info
[0m14:41:21.251550 [debug] [Thread-1  ]: Began executing node model.hu_dw_datawarehouse.test_table_2
[0m14:41:21.299195 [debug] [Thread-1  ]: Writing runtime SQL for node "model.hu_dw_datawarehouse.test_table_2"
[0m14:41:21.299826 [debug] [Thread-1  ]: Using postgres connection "model.hu_dw_datawarehouse.test_table_2"
[0m14:41:21.300032 [debug] [Thread-1  ]: On model.hu_dw_datawarehouse.test_table_2: BEGIN
[0m14:41:21.300170 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m14:41:22.613628 [debug] [Thread-1  ]: SQL status: BEGIN in 1.31 seconds
[0m14:41:22.613857 [debug] [Thread-1  ]: Using postgres connection "model.hu_dw_datawarehouse.test_table_2"
[0m14:41:22.614013 [debug] [Thread-1  ]: On model.hu_dw_datawarehouse.test_table_2: /* {"app": "dbt", "dbt_version": "1.2.2", "profile_name": "default", "target_name": "postgres", "node_id": "model.hu_dw_datawarehouse.test_table_2"} */


  create  table "defaultdb"."featuredata3405_scratch"."test_table_2__dbt_tmp"
  as (
    

SELECT col
, col*2 AS col_power_2
FROM
"defaultdb"."featuredata3405_scratch"."test_table_1"
  );
[0m14:41:22.778215 [debug] [Thread-1  ]: SQL status: SELECT 5 in 0.16 seconds
[0m14:41:22.784622 [debug] [Thread-1  ]: Using postgres connection "model.hu_dw_datawarehouse.test_table_2"
[0m14:41:22.784854 [debug] [Thread-1  ]: On model.hu_dw_datawarehouse.test_table_2: /* {"app": "dbt", "dbt_version": "1.2.2", "profile_name": "default", "target_name": "postgres", "node_id": "model.hu_dw_datawarehouse.test_table_2"} */
alter table "defaultdb"."featuredata3405_scratch"."test_table_2" rename to "test_table_2__dbt_backup"
[0m14:41:22.937674 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.15 seconds
[0m14:41:22.940266 [debug] [Thread-1  ]: Using postgres connection "model.hu_dw_datawarehouse.test_table_2"
[0m14:41:22.940476 [debug] [Thread-1  ]: On model.hu_dw_datawarehouse.test_table_2: /* {"app": "dbt", "dbt_version": "1.2.2", "profile_name": "default", "target_name": "postgres", "node_id": "model.hu_dw_datawarehouse.test_table_2"} */
alter table "defaultdb"."featuredata3405_scratch"."test_table_2__dbt_tmp" rename to "test_table_2"
[0m14:41:23.090122 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.15 seconds
[0m14:41:23.116336 [debug] [Thread-1  ]: On model.hu_dw_datawarehouse.test_table_2: COMMIT
[0m14:41:23.116594 [debug] [Thread-1  ]: Using postgres connection "model.hu_dw_datawarehouse.test_table_2"
[0m14:41:23.116726 [debug] [Thread-1  ]: On model.hu_dw_datawarehouse.test_table_2: COMMIT
[0m14:41:23.262596 [debug] [Thread-1  ]: SQL status: COMMIT in 0.15 seconds
[0m14:41:23.267721 [debug] [Thread-1  ]: Using postgres connection "model.hu_dw_datawarehouse.test_table_2"
[0m14:41:23.267940 [debug] [Thread-1  ]: On model.hu_dw_datawarehouse.test_table_2: /* {"app": "dbt", "dbt_version": "1.2.2", "profile_name": "default", "target_name": "postgres", "node_id": "model.hu_dw_datawarehouse.test_table_2"} */
drop table if exists "defaultdb"."featuredata3405_scratch"."test_table_2__dbt_backup" cascade
[0m14:41:23.413456 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.15 seconds
[0m14:41:23.414711 [debug] [Thread-1  ]: finished collecting timing info
[0m14:41:23.414941 [debug] [Thread-1  ]: On model.hu_dw_datawarehouse.test_table_2: Close
[0m14:41:23.415506 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '41324715-da92-4e51-844d-0c9419112760', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffb7a9bcfd0>]}
[0m14:41:23.415888 [info ] [Thread-1  ]: 1 of 1 OK created table model featuredata3405_scratch.test_table_2 ............. [[32mSELECT 5[0m in 2.17s]
[0m14:41:23.416344 [debug] [Thread-1  ]: Finished running node model.hu_dw_datawarehouse.test_table_2
[0m14:41:23.417754 [debug] [MainThread]: Acquiring new postgres connection "master"
[0m14:41:23.418010 [debug] [MainThread]: Using postgres connection "master"
[0m14:41:23.418160 [debug] [MainThread]: On master: BEGIN
[0m14:41:23.418282 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:41:24.436302 [debug] [MainThread]: SQL status: BEGIN in 1.02 seconds
[0m14:41:24.436572 [debug] [MainThread]: On master: COMMIT
[0m14:41:24.436706 [debug] [MainThread]: Using postgres connection "master"
[0m14:41:24.436823 [debug] [MainThread]: On master: COMMIT
[0m14:41:24.561406 [debug] [MainThread]: SQL status: COMMIT in 0.12 seconds
[0m14:41:24.561680 [debug] [MainThread]: On master: Close
[0m14:41:24.562398 [info ] [MainThread]: 
[0m14:41:24.562658 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 7.24 seconds (7.24s).
[0m14:41:24.562908 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:41:24.563026 [debug] [MainThread]: Connection 'model.hu_dw_datawarehouse.test_table_2' was properly closed.
[0m14:41:24.569800 [info ] [MainThread]: 
[0m14:41:24.570099 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:41:24.570403 [info ] [MainThread]: 
[0m14:41:24.570668 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m14:41:24.571033 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffb7aababe0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffb7aaba580>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffb7aaba5b0>]}
[0m14:41:24.571424 [debug] [MainThread]: Flushing usage events


============================== 2022-10-10 15:36:40.545680 | 7699fb12-4405-46ef-b22d-b80fa076298e ==============================
[0m15:36:40.545691 [info ] [MainThread]: Running with dbt=1.2.2
[0m15:36:40.547975 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/okolesnikov/Documents/health-union/Repos/DATA-3405-test/profiles.yml', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'config_dir': True, 'which': 'debug', 'indirect_selection': 'eager'}
[0m15:36:40.548396 [debug] [MainThread]: Tracking: tracking
[0m15:36:40.569192 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8747e6e6d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8747e3c0a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8747e3cf40>]}
[0m15:36:40.571078 [info ] [MainThread]: To view your profiles.yml file, run:

open /Users/okolesnikov/Documents/health-union/Repos/DATA-3405-test/profiles.yml
[0m15:36:40.571542 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8747e3cf40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f874416ec40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8747e334c0>]}
[0m15:36:40.571817 [debug] [MainThread]: Flushing usage events


============================== 2022-10-10 15:38:27.924277 | 449868b2-81ae-4b6d-b335-4fc153978674 ==============================
[0m15:38:27.924308 [info ] [MainThread]: Running with dbt=1.2.2
[0m15:38:27.926240 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/okolesnikov/Documents/health-union/Repos/DATA-3405-test', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'target': 'postgres', 'select': ['+test_table_3'], 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m15:38:27.926439 [debug] [MainThread]: Tracking: tracking
[0m15:38:27.951856 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdfb4eaf9d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdfb4eaff70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdfb4e99160>]}
[0m15:38:27.977412 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m15:38:27.977997 [info ] [MainThread]: Unable to do partial parsing because profile has changed
[0m15:38:27.978261 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '449868b2-81ae-4b6d-b335-4fc153978674', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdfb4db3f10>]}
[0m15:38:28.033626 [debug] [MainThread]: Parsing macros/catalog.sql
[0m15:38:28.040330 [debug] [MainThread]: Parsing macros/relations.sql
[0m15:38:28.041863 [debug] [MainThread]: Parsing macros/adapters.sql
[0m15:38:28.069200 [debug] [MainThread]: Parsing macros/materializations/snapshot_merge.sql
[0m15:38:28.070883 [debug] [MainThread]: Parsing macros/utils/dateadd.sql
[0m15:38:28.071495 [debug] [MainThread]: Parsing macros/utils/listagg.sql
[0m15:38:28.072959 [debug] [MainThread]: Parsing macros/utils/datediff.sql
[0m15:38:28.079411 [debug] [MainThread]: Parsing macros/utils/any_value.sql
[0m15:38:28.079910 [debug] [MainThread]: Parsing macros/utils/last_day.sql
[0m15:38:28.081454 [debug] [MainThread]: Parsing macros/utils/split_part.sql
[0m15:38:28.082729 [debug] [MainThread]: Parsing macros/materializations/hooks.sql
[0m15:38:28.086723 [debug] [MainThread]: Parsing macros/materializations/configs.sql
[0m15:38:28.088926 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot_merge.sql
[0m15:38:28.090473 [debug] [MainThread]: Parsing macros/materializations/snapshots/strategies.sql
[0m15:38:28.136219 [debug] [MainThread]: Parsing macros/materializations/snapshots/helpers.sql
[0m15:38:28.148972 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot.sql
[0m15:38:28.160930 [debug] [MainThread]: Parsing macros/materializations/tests/test.sql
[0m15:38:28.165322 [debug] [MainThread]: Parsing macros/materializations/tests/helpers.sql
[0m15:38:28.167001 [debug] [MainThread]: Parsing macros/materializations/tests/where_subquery.sql
[0m15:38:28.168995 [debug] [MainThread]: Parsing macros/materializations/models/incremental/column_helpers.sql
[0m15:38:28.173466 [debug] [MainThread]: Parsing macros/materializations/models/incremental/merge.sql
[0m15:38:28.190022 [debug] [MainThread]: Parsing macros/materializations/models/incremental/is_incremental.sql
[0m15:38:28.191774 [debug] [MainThread]: Parsing macros/materializations/models/incremental/incremental.sql
[0m15:38:28.201673 [debug] [MainThread]: Parsing macros/materializations/models/incremental/on_schema_change.sql
[0m15:38:28.216768 [debug] [MainThread]: Parsing macros/materializations/models/table/table.sql
[0m15:38:28.222608 [debug] [MainThread]: Parsing macros/materializations/models/table/create_table_as.sql
[0m15:38:28.225391 [debug] [MainThread]: Parsing macros/materializations/models/view/view.sql
[0m15:38:28.230625 [debug] [MainThread]: Parsing macros/materializations/models/view/helpers.sql
[0m15:38:28.231862 [debug] [MainThread]: Parsing macros/materializations/models/view/create_or_replace_view.sql
[0m15:38:28.235235 [debug] [MainThread]: Parsing macros/materializations/models/view/create_view_as.sql
[0m15:38:28.237442 [debug] [MainThread]: Parsing macros/materializations/seeds/seed.sql
[0m15:38:28.244435 [debug] [MainThread]: Parsing macros/materializations/seeds/helpers.sql
[0m15:38:28.262650 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_alias.sql
[0m15:38:28.264255 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_schema.sql
[0m15:38:28.266699 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_database.sql
[0m15:38:28.268578 [debug] [MainThread]: Parsing macros/generic_test_sql/relationships.sql
[0m15:38:28.269430 [debug] [MainThread]: Parsing macros/generic_test_sql/not_null.sql
[0m15:38:28.270236 [debug] [MainThread]: Parsing macros/generic_test_sql/unique.sql
[0m15:38:28.270872 [debug] [MainThread]: Parsing macros/generic_test_sql/accepted_values.sql
[0m15:38:28.272145 [debug] [MainThread]: Parsing macros/etc/statement.sql
[0m15:38:28.276443 [debug] [MainThread]: Parsing macros/etc/datetime.sql
[0m15:38:28.284827 [debug] [MainThread]: Parsing macros/utils/except.sql
[0m15:38:28.285666 [debug] [MainThread]: Parsing macros/utils/replace.sql
[0m15:38:28.286878 [debug] [MainThread]: Parsing macros/utils/concat.sql
[0m15:38:28.287772 [debug] [MainThread]: Parsing macros/utils/length.sql
[0m15:38:28.288666 [debug] [MainThread]: Parsing macros/utils/dateadd.sql
[0m15:38:28.289976 [debug] [MainThread]: Parsing macros/utils/intersect.sql
[0m15:38:28.290739 [debug] [MainThread]: Parsing macros/utils/escape_single_quotes.sql
[0m15:38:28.291740 [debug] [MainThread]: Parsing macros/utils/right.sql
[0m15:38:28.292770 [debug] [MainThread]: Parsing macros/utils/listagg.sql
[0m15:38:28.295061 [debug] [MainThread]: Parsing macros/utils/datediff.sql
[0m15:38:28.296226 [debug] [MainThread]: Parsing macros/utils/safe_cast.sql
[0m15:38:28.297330 [debug] [MainThread]: Parsing macros/utils/hash.sql
[0m15:38:28.298409 [debug] [MainThread]: Parsing macros/utils/cast_bool_to_text.sql
[0m15:38:28.299406 [debug] [MainThread]: Parsing macros/utils/any_value.sql
[0m15:38:28.300269 [debug] [MainThread]: Parsing macros/utils/position.sql
[0m15:38:28.301297 [debug] [MainThread]: Parsing macros/utils/literal.sql
[0m15:38:28.302247 [debug] [MainThread]: Parsing macros/utils/data_types.sql
[0m15:38:28.309749 [debug] [MainThread]: Parsing macros/utils/bool_or.sql
[0m15:38:28.310724 [debug] [MainThread]: Parsing macros/utils/last_day.sql
[0m15:38:28.312439 [debug] [MainThread]: Parsing macros/utils/split_part.sql
[0m15:38:28.314627 [debug] [MainThread]: Parsing macros/utils/date_trunc.sql
[0m15:38:28.315721 [debug] [MainThread]: Parsing macros/adapters/schema.sql
[0m15:38:28.317894 [debug] [MainThread]: Parsing macros/adapters/indexes.sql
[0m15:38:28.320923 [debug] [MainThread]: Parsing macros/adapters/relation.sql
[0m15:38:28.335496 [debug] [MainThread]: Parsing macros/adapters/freshness.sql
[0m15:38:28.338422 [debug] [MainThread]: Parsing macros/adapters/apply_grants.sql
[0m15:38:28.351517 [debug] [MainThread]: Parsing macros/adapters/persist_docs.sql
[0m15:38:28.355974 [debug] [MainThread]: Parsing macros/adapters/metadata.sql
[0m15:38:28.363423 [debug] [MainThread]: Parsing macros/adapters/columns.sql
[0m15:38:28.373478 [debug] [MainThread]: Parsing tests/generic/builtin.sql
[0m15:38:28.604627 [debug] [MainThread]: 1603: static parser failed on test_table_1.sql
[0m15:38:28.617106 [debug] [MainThread]: 1602: parser fallback to jinja rendering on test_table_1.sql
[0m15:38:28.618614 [debug] [MainThread]: 1603: static parser failed on test_table_2.sql
[0m15:38:28.622402 [debug] [MainThread]: 1602: parser fallback to jinja rendering on test_table_2.sql
[0m15:38:28.623621 [debug] [MainThread]: 1603: static parser failed on test_table_3.sql
[0m15:38:28.627821 [debug] [MainThread]: 1602: parser fallback to jinja rendering on test_table_3.sql
[0m15:38:28.651132 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdfb4f3bfa0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdfb5067fd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdfb5067d90>]}
[0m15:38:28.651511 [debug] [MainThread]: Flushing usage events
[0m15:38:29.245887 [error] [MainThread]: Encountered an error:
Compilation Error in model test_table_1 (models/test_table_1.sql)
  Model 'model.hu_dw_datawarehouse.test_table_1' (models/test_table_1.sql) depends on a source named 'featuredata3405_scratch.source_table' which was not found
[0m15:38:29.254606 [error] [MainThread]: Traceback (most recent call last):
  File "/Users/okolesnikov/opt/anaconda3/lib/python3.9/site-packages/dbt/main.py", line 129, in main
    results, succeeded = handle_and_check(args)
  File "/Users/okolesnikov/opt/anaconda3/lib/python3.9/site-packages/dbt/main.py", line 191, in handle_and_check
    task, res = run_from_args(parsed)
  File "/Users/okolesnikov/opt/anaconda3/lib/python3.9/site-packages/dbt/main.py", line 238, in run_from_args
    results = task.run()
  File "/Users/okolesnikov/opt/anaconda3/lib/python3.9/site-packages/dbt/task/runnable.py", line 451, in run
    self._runtime_initialize()
  File "/Users/okolesnikov/opt/anaconda3/lib/python3.9/site-packages/dbt/task/runnable.py", line 159, in _runtime_initialize
    super()._runtime_initialize()
  File "/Users/okolesnikov/opt/anaconda3/lib/python3.9/site-packages/dbt/task/runnable.py", line 92, in _runtime_initialize
    self.load_manifest()
  File "/Users/okolesnikov/opt/anaconda3/lib/python3.9/site-packages/dbt/task/runnable.py", line 81, in load_manifest
    self.manifest = ManifestLoader.get_full_manifest(self.config)
  File "/Users/okolesnikov/opt/anaconda3/lib/python3.9/site-packages/dbt/parser/manifest.py", line 219, in get_full_manifest
    manifest = loader.load()
  File "/Users/okolesnikov/opt/anaconda3/lib/python3.9/site-packages/dbt/parser/manifest.py", line 390, in load
    self.process_sources(self.root_project.project_name)
  File "/Users/okolesnikov/opt/anaconda3/lib/python3.9/site-packages/dbt/parser/manifest.py", line 921, in process_sources
    _process_sources_for_node(self.manifest, current_project, node)
  File "/Users/okolesnikov/opt/anaconda3/lib/python3.9/site-packages/dbt/parser/manifest.py", line 1302, in _process_sources_for_node
    invalid_source_fail_unless_test(
  File "/Users/okolesnikov/opt/anaconda3/lib/python3.9/site-packages/dbt/parser/manifest.py", line 955, in invalid_source_fail_unless_test
    source_target_not_found(node, target_name, target_table_name, disabled=disabled)
  File "/Users/okolesnikov/opt/anaconda3/lib/python3.9/site-packages/dbt/exceptions.py", line 656, in source_target_not_found
    raise_compiler_error(msg, model)
  File "/Users/okolesnikov/opt/anaconda3/lib/python3.9/site-packages/dbt/exceptions.py", line 445, in raise_compiler_error
    raise CompilationException(msg, node)
dbt.exceptions.CompilationException: Compilation Error in model test_table_1 (models/test_table_1.sql)
  Model 'model.hu_dw_datawarehouse.test_table_1' (models/test_table_1.sql) depends on a source named 'featuredata3405_scratch.source_table' which was not found



============================== 2022-10-10 15:39:05.087711 | a581ab75-b658-4fbf-9acd-e101e73ade4f ==============================
[0m15:39:05.087752 [info ] [MainThread]: Running with dbt=1.2.2
[0m15:39:05.088958 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/okolesnikov/Documents/health-union/Repos/DATA-3405-test', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'target': 'postgres', 'select': ['+test_table_3'], 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m15:39:05.089378 [debug] [MainThread]: Tracking: tracking
[0m15:39:05.109086 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa3dff279a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa3dff27bb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa3dff23df0>]}
[0m15:39:05.134039 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m15:39:05.134493 [info ] [MainThread]: Unable to do partial parsing because profile has changed
[0m15:39:05.134759 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'a581ab75-b658-4fbf-9acd-e101e73ade4f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa3dfd33f40>]}
[0m15:39:05.154438 [debug] [MainThread]: Parsing macros/catalog.sql
[0m15:39:05.157961 [debug] [MainThread]: Parsing macros/relations.sql
[0m15:39:05.159818 [debug] [MainThread]: Parsing macros/adapters.sql
[0m15:39:05.187124 [debug] [MainThread]: Parsing macros/materializations/snapshot_merge.sql
[0m15:39:05.188903 [debug] [MainThread]: Parsing macros/utils/dateadd.sql
[0m15:39:05.189573 [debug] [MainThread]: Parsing macros/utils/listagg.sql
[0m15:39:05.190932 [debug] [MainThread]: Parsing macros/utils/datediff.sql
[0m15:39:05.197819 [debug] [MainThread]: Parsing macros/utils/any_value.sql
[0m15:39:05.198565 [debug] [MainThread]: Parsing macros/utils/last_day.sql
[0m15:39:05.199839 [debug] [MainThread]: Parsing macros/utils/split_part.sql
[0m15:39:05.200993 [debug] [MainThread]: Parsing macros/materializations/hooks.sql
[0m15:39:05.205324 [debug] [MainThread]: Parsing macros/materializations/configs.sql
[0m15:39:05.207957 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot_merge.sql
[0m15:39:05.209588 [debug] [MainThread]: Parsing macros/materializations/snapshots/strategies.sql
[0m15:39:05.255921 [debug] [MainThread]: Parsing macros/materializations/snapshots/helpers.sql
[0m15:39:05.268579 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot.sql
[0m15:39:05.280542 [debug] [MainThread]: Parsing macros/materializations/tests/test.sql
[0m15:39:05.285072 [debug] [MainThread]: Parsing macros/materializations/tests/helpers.sql
[0m15:39:05.286938 [debug] [MainThread]: Parsing macros/materializations/tests/where_subquery.sql
[0m15:39:05.288632 [debug] [MainThread]: Parsing macros/materializations/models/incremental/column_helpers.sql
[0m15:39:05.293318 [debug] [MainThread]: Parsing macros/materializations/models/incremental/merge.sql
[0m15:39:05.309637 [debug] [MainThread]: Parsing macros/materializations/models/incremental/is_incremental.sql
[0m15:39:05.311160 [debug] [MainThread]: Parsing macros/materializations/models/incremental/incremental.sql
[0m15:39:05.320755 [debug] [MainThread]: Parsing macros/materializations/models/incremental/on_schema_change.sql
[0m15:39:05.336927 [debug] [MainThread]: Parsing macros/materializations/models/table/table.sql
[0m15:39:05.342452 [debug] [MainThread]: Parsing macros/materializations/models/table/create_table_as.sql
[0m15:39:05.345372 [debug] [MainThread]: Parsing macros/materializations/models/view/view.sql
[0m15:39:05.352141 [debug] [MainThread]: Parsing macros/materializations/models/view/helpers.sql
[0m15:39:05.354078 [debug] [MainThread]: Parsing macros/materializations/models/view/create_or_replace_view.sql
[0m15:39:05.358094 [debug] [MainThread]: Parsing macros/materializations/models/view/create_view_as.sql
[0m15:39:05.360527 [debug] [MainThread]: Parsing macros/materializations/seeds/seed.sql
[0m15:39:05.367507 [debug] [MainThread]: Parsing macros/materializations/seeds/helpers.sql
[0m15:39:05.386287 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_alias.sql
[0m15:39:05.387878 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_schema.sql
[0m15:39:05.390187 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_database.sql
[0m15:39:05.391663 [debug] [MainThread]: Parsing macros/generic_test_sql/relationships.sql
[0m15:39:05.392474 [debug] [MainThread]: Parsing macros/generic_test_sql/not_null.sql
[0m15:39:05.393238 [debug] [MainThread]: Parsing macros/generic_test_sql/unique.sql
[0m15:39:05.393885 [debug] [MainThread]: Parsing macros/generic_test_sql/accepted_values.sql
[0m15:39:05.395346 [debug] [MainThread]: Parsing macros/etc/statement.sql
[0m15:39:05.399889 [debug] [MainThread]: Parsing macros/etc/datetime.sql
[0m15:39:05.408258 [debug] [MainThread]: Parsing macros/utils/except.sql
[0m15:39:05.409128 [debug] [MainThread]: Parsing macros/utils/replace.sql
[0m15:39:05.410290 [debug] [MainThread]: Parsing macros/utils/concat.sql
[0m15:39:05.411283 [debug] [MainThread]: Parsing macros/utils/length.sql
[0m15:39:05.412174 [debug] [MainThread]: Parsing macros/utils/dateadd.sql
[0m15:39:05.413331 [debug] [MainThread]: Parsing macros/utils/intersect.sql
[0m15:39:05.414093 [debug] [MainThread]: Parsing macros/utils/escape_single_quotes.sql
[0m15:39:05.415056 [debug] [MainThread]: Parsing macros/utils/right.sql
[0m15:39:05.416055 [debug] [MainThread]: Parsing macros/utils/listagg.sql
[0m15:39:05.418734 [debug] [MainThread]: Parsing macros/utils/datediff.sql
[0m15:39:05.420272 [debug] [MainThread]: Parsing macros/utils/safe_cast.sql
[0m15:39:05.421363 [debug] [MainThread]: Parsing macros/utils/hash.sql
[0m15:39:05.422393 [debug] [MainThread]: Parsing macros/utils/cast_bool_to_text.sql
[0m15:39:05.423596 [debug] [MainThread]: Parsing macros/utils/any_value.sql
[0m15:39:05.424493 [debug] [MainThread]: Parsing macros/utils/position.sql
[0m15:39:05.425521 [debug] [MainThread]: Parsing macros/utils/literal.sql
[0m15:39:05.426408 [debug] [MainThread]: Parsing macros/utils/data_types.sql
[0m15:39:05.432372 [debug] [MainThread]: Parsing macros/utils/bool_or.sql
[0m15:39:05.433706 [debug] [MainThread]: Parsing macros/utils/last_day.sql
[0m15:39:05.435571 [debug] [MainThread]: Parsing macros/utils/split_part.sql
[0m15:39:05.437515 [debug] [MainThread]: Parsing macros/utils/date_trunc.sql
[0m15:39:05.438498 [debug] [MainThread]: Parsing macros/adapters/schema.sql
[0m15:39:05.440824 [debug] [MainThread]: Parsing macros/adapters/indexes.sql
[0m15:39:05.443494 [debug] [MainThread]: Parsing macros/adapters/relation.sql
[0m15:39:05.458213 [debug] [MainThread]: Parsing macros/adapters/freshness.sql
[0m15:39:05.461208 [debug] [MainThread]: Parsing macros/adapters/apply_grants.sql
[0m15:39:05.474719 [debug] [MainThread]: Parsing macros/adapters/persist_docs.sql
[0m15:39:05.479184 [debug] [MainThread]: Parsing macros/adapters/metadata.sql
[0m15:39:05.486525 [debug] [MainThread]: Parsing macros/adapters/columns.sql
[0m15:39:05.496283 [debug] [MainThread]: Parsing tests/generic/builtin.sql
[0m15:39:05.729186 [debug] [MainThread]: 1603: static parser failed on test_table_1.sql
[0m15:39:05.741912 [debug] [MainThread]: 1602: parser fallback to jinja rendering on test_table_1.sql
[0m15:39:05.743184 [debug] [MainThread]: 1603: static parser failed on test_table_2.sql
[0m15:39:05.746955 [debug] [MainThread]: 1602: parser fallback to jinja rendering on test_table_2.sql
[0m15:39:05.748242 [debug] [MainThread]: 1603: static parser failed on test_table_3.sql
[0m15:39:05.752517 [debug] [MainThread]: 1602: parser fallback to jinja rendering on test_table_3.sql
[0m15:39:05.797279 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a581ab75-b658-4fbf-9acd-e101e73ade4f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa3e0224d60>]}
[0m15:39:05.803345 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a581ab75-b658-4fbf-9acd-e101e73ade4f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa3dff259a0>]}
[0m15:39:05.803691 [info ] [MainThread]: Found 3 models, 0 tests, 0 snapshots, 0 analyses, 256 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics
[0m15:39:05.803949 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a581ab75-b658-4fbf-9acd-e101e73ade4f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa3dff73880>]}
[0m15:39:05.805190 [info ] [MainThread]: 
[0m15:39:05.805741 [debug] [MainThread]: Acquiring new postgres connection "master"
[0m15:39:05.806916 [debug] [ThreadPool]: Acquiring new postgres connection "list_defaultdb"
[0m15:39:05.817896 [debug] [ThreadPool]: Using postgres connection "list_defaultdb"
[0m15:39:05.818136 [debug] [ThreadPool]: On list_defaultdb: /* {"app": "dbt", "dbt_version": "1.2.2", "profile_name": "default", "target_name": "postgres", "connection_name": "list_defaultdb"} */

    select distinct nspname from pg_namespace
  
[0m15:39:05.818270 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:39:07.002393 [debug] [ThreadPool]: SQL status: SELECT 5 in 1.18 seconds
[0m15:39:07.004628 [debug] [ThreadPool]: On list_defaultdb: Close
[0m15:39:07.006356 [debug] [ThreadPool]: Acquiring new postgres connection "list_defaultdb_featuredata3405_scratch"
[0m15:39:07.013897 [debug] [ThreadPool]: Using postgres connection "list_defaultdb_featuredata3405_scratch"
[0m15:39:07.014146 [debug] [ThreadPool]: On list_defaultdb_featuredata3405_scratch: BEGIN
[0m15:39:07.014335 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:39:08.007828 [debug] [ThreadPool]: SQL status: BEGIN in 0.99 seconds
[0m15:39:08.008628 [debug] [ThreadPool]: Using postgres connection "list_defaultdb_featuredata3405_scratch"
[0m15:39:08.009140 [debug] [ThreadPool]: On list_defaultdb_featuredata3405_scratch: /* {"app": "dbt", "dbt_version": "1.2.2", "profile_name": "default", "target_name": "postgres", "connection_name": "list_defaultdb_featuredata3405_scratch"} */
select
      'defaultdb' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'featuredata3405_scratch'
    union all
    select
      'defaultdb' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'featuredata3405_scratch'
  
[0m15:39:08.131976 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.12 seconds
[0m15:39:08.134355 [debug] [ThreadPool]: On list_defaultdb_featuredata3405_scratch: ROLLBACK
[0m15:39:08.254618 [debug] [ThreadPool]: On list_defaultdb_featuredata3405_scratch: Close
[0m15:39:08.266260 [debug] [MainThread]: Using postgres connection "master"
[0m15:39:08.266728 [debug] [MainThread]: On master: BEGIN
[0m15:39:08.267038 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:39:09.471038 [debug] [MainThread]: SQL status: BEGIN in 1.2 seconds
[0m15:39:09.471318 [debug] [MainThread]: Using postgres connection "master"
[0m15:39:09.471581 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.2.2", "profile_name": "default", "target_name": "postgres", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m15:39:09.632561 [debug] [MainThread]: SQL status: SELECT 0 in 0.16 seconds
[0m15:39:09.633889 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a581ab75-b658-4fbf-9acd-e101e73ade4f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa3dffa4700>]}
[0m15:39:09.634291 [debug] [MainThread]: On master: ROLLBACK
[0m15:39:09.792716 [debug] [MainThread]: Using postgres connection "master"
[0m15:39:09.792969 [debug] [MainThread]: On master: BEGIN
[0m15:39:10.098958 [debug] [MainThread]: SQL status: BEGIN in 0.31 seconds
[0m15:39:10.099854 [debug] [MainThread]: On master: COMMIT
[0m15:39:10.100421 [debug] [MainThread]: Using postgres connection "master"
[0m15:39:10.100922 [debug] [MainThread]: On master: COMMIT
[0m15:39:10.250679 [debug] [MainThread]: SQL status: COMMIT in 0.15 seconds
[0m15:39:10.251765 [debug] [MainThread]: On master: Close
[0m15:39:10.253564 [info ] [MainThread]: Concurrency: 4 threads (target='postgres')
[0m15:39:10.254520 [info ] [MainThread]: 
[0m15:39:10.262554 [debug] [Thread-1  ]: Began running node model.hu_dw_datawarehouse.test_table_1
[0m15:39:10.263196 [info ] [Thread-1  ]: 1 of 3 START table model featuredata3405_scratch.test_table_1 .................. [RUN]
[0m15:39:10.264143 [debug] [Thread-1  ]: Acquiring new postgres connection "model.hu_dw_datawarehouse.test_table_1"
[0m15:39:10.264518 [debug] [Thread-1  ]: Began compiling node model.hu_dw_datawarehouse.test_table_1
[0m15:39:10.264871 [debug] [Thread-1  ]: Compiling model.hu_dw_datawarehouse.test_table_1
[0m15:39:10.270360 [debug] [Thread-1  ]: Writing injected SQL for node "model.hu_dw_datawarehouse.test_table_1"
[0m15:39:10.271824 [debug] [Thread-1  ]: finished collecting timing info
[0m15:39:10.272208 [debug] [Thread-1  ]: Began executing node model.hu_dw_datawarehouse.test_table_1
[0m15:39:10.320050 [debug] [Thread-1  ]: Writing runtime SQL for node "model.hu_dw_datawarehouse.test_table_1"
[0m15:39:10.320679 [debug] [Thread-1  ]: Using postgres connection "model.hu_dw_datawarehouse.test_table_1"
[0m15:39:10.320868 [debug] [Thread-1  ]: On model.hu_dw_datawarehouse.test_table_1: BEGIN
[0m15:39:10.321123 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m15:39:11.284967 [debug] [Thread-1  ]: SQL status: BEGIN in 0.96 seconds
[0m15:39:11.285722 [debug] [Thread-1  ]: Using postgres connection "model.hu_dw_datawarehouse.test_table_1"
[0m15:39:11.286517 [debug] [Thread-1  ]: On model.hu_dw_datawarehouse.test_table_1: /* {"app": "dbt", "dbt_version": "1.2.2", "profile_name": "default", "target_name": "postgres", "node_id": "model.hu_dw_datawarehouse.test_table_1"} */


  create  table "defaultdb"."featuredata3405_scratch"."test_table_1__dbt_tmp"
  as (
    

SELECT 
col
, POWER(col,2) AS col_power_2
FROM
"defaultdb"."featuredata3405_scratch"."source_table"
  );
[0m15:39:11.408471 [debug] [Thread-1  ]: SQL status: SELECT 5 in 0.12 seconds
[0m15:39:11.423046 [debug] [Thread-1  ]: Using postgres connection "model.hu_dw_datawarehouse.test_table_1"
[0m15:39:11.423459 [debug] [Thread-1  ]: On model.hu_dw_datawarehouse.test_table_1: /* {"app": "dbt", "dbt_version": "1.2.2", "profile_name": "default", "target_name": "postgres", "node_id": "model.hu_dw_datawarehouse.test_table_1"} */
alter table "defaultdb"."featuredata3405_scratch"."test_table_1__dbt_tmp" rename to "test_table_1"
[0m15:39:11.542796 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.12 seconds
[0m15:39:11.574993 [debug] [Thread-1  ]: On model.hu_dw_datawarehouse.test_table_1: COMMIT
[0m15:39:11.575245 [debug] [Thread-1  ]: Using postgres connection "model.hu_dw_datawarehouse.test_table_1"
[0m15:39:11.575396 [debug] [Thread-1  ]: On model.hu_dw_datawarehouse.test_table_1: COMMIT
[0m15:39:11.694598 [debug] [Thread-1  ]: SQL status: COMMIT in 0.12 seconds
[0m15:39:11.707040 [debug] [Thread-1  ]: Using postgres connection "model.hu_dw_datawarehouse.test_table_1"
[0m15:39:11.707401 [debug] [Thread-1  ]: On model.hu_dw_datawarehouse.test_table_1: /* {"app": "dbt", "dbt_version": "1.2.2", "profile_name": "default", "target_name": "postgres", "node_id": "model.hu_dw_datawarehouse.test_table_1"} */
drop table if exists "defaultdb"."featuredata3405_scratch"."test_table_1__dbt_backup" cascade
[0m15:39:11.826969 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.12 seconds
[0m15:39:11.830910 [debug] [Thread-1  ]: finished collecting timing info
[0m15:39:11.831377 [debug] [Thread-1  ]: On model.hu_dw_datawarehouse.test_table_1: Close
[0m15:39:11.832680 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a581ab75-b658-4fbf-9acd-e101e73ade4f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa3e03d3e50>]}
[0m15:39:11.833681 [info ] [Thread-1  ]: 1 of 3 OK created table model featuredata3405_scratch.test_table_1 ............. [[32mSELECT 5[0m in 1.57s]
[0m15:39:11.834796 [debug] [Thread-1  ]: Finished running node model.hu_dw_datawarehouse.test_table_1
[0m15:39:11.836299 [debug] [Thread-3  ]: Began running node model.hu_dw_datawarehouse.test_table_2
[0m15:39:11.836970 [info ] [Thread-3  ]: 2 of 3 START table model featuredata3405_scratch.test_table_2 .................. [RUN]
[0m15:39:11.837883 [debug] [Thread-3  ]: Acquiring new postgres connection "model.hu_dw_datawarehouse.test_table_2"
[0m15:39:11.838261 [debug] [Thread-3  ]: Began compiling node model.hu_dw_datawarehouse.test_table_2
[0m15:39:11.838587 [debug] [Thread-3  ]: Compiling model.hu_dw_datawarehouse.test_table_2
[0m15:39:11.844446 [debug] [Thread-3  ]: Writing injected SQL for node "model.hu_dw_datawarehouse.test_table_2"
[0m15:39:11.845371 [debug] [Thread-3  ]: finished collecting timing info
[0m15:39:11.845735 [debug] [Thread-3  ]: Began executing node model.hu_dw_datawarehouse.test_table_2
[0m15:39:11.853680 [debug] [Thread-3  ]: Writing runtime SQL for node "model.hu_dw_datawarehouse.test_table_2"
[0m15:39:11.854562 [debug] [Thread-3  ]: Using postgres connection "model.hu_dw_datawarehouse.test_table_2"
[0m15:39:11.854865 [debug] [Thread-3  ]: On model.hu_dw_datawarehouse.test_table_2: BEGIN
[0m15:39:11.855044 [debug] [Thread-3  ]: Opening a new connection, currently in state init
[0m15:39:12.835236 [debug] [Thread-3  ]: SQL status: BEGIN in 0.98 seconds
[0m15:39:12.835989 [debug] [Thread-3  ]: Using postgres connection "model.hu_dw_datawarehouse.test_table_2"
[0m15:39:12.836541 [debug] [Thread-3  ]: On model.hu_dw_datawarehouse.test_table_2: /* {"app": "dbt", "dbt_version": "1.2.2", "profile_name": "default", "target_name": "postgres", "node_id": "model.hu_dw_datawarehouse.test_table_2"} */


  create  table "defaultdb"."featuredata3405_scratch"."test_table_2__dbt_tmp"
  as (
    

SELECT 
col
, col_power_2
, POWER(col,3) AS col_power_3
FROM
"defaultdb"."featuredata3405_scratch"."test_table_1"
where smth = 0
  );
[0m15:39:12.974565 [debug] [Thread-3  ]: Postgres adapter: Postgres error: column "smth" does not exist
LINE 14: where smth = 0
               ^

[0m15:39:12.975396 [debug] [Thread-3  ]: On model.hu_dw_datawarehouse.test_table_2: ROLLBACK
[0m15:39:13.097934 [debug] [Thread-3  ]: finished collecting timing info
[0m15:39:13.098551 [debug] [Thread-3  ]: On model.hu_dw_datawarehouse.test_table_2: Close
[0m15:39:13.099916 [debug] [Thread-3  ]: Database Error in model test_table_2 (models/test_table_2.sql)
  column "smth" does not exist
  LINE 14: where smth = 0
                 ^
  compiled SQL at target/run/hu_dw_datawarehouse/models/test_table_2.sql
[0m15:39:13.100666 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a581ab75-b658-4fbf-9acd-e101e73ade4f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa3dffd68b0>]}
[0m15:39:13.101443 [error] [Thread-3  ]: 2 of 3 ERROR creating table model featuredata3405_scratch.test_table_2 ......... [[31mERROR[0m in 1.26s]
[0m15:39:13.102357 [debug] [Thread-3  ]: Finished running node model.hu_dw_datawarehouse.test_table_2
[0m15:39:13.103489 [debug] [Thread-2  ]: Began running node model.hu_dw_datawarehouse.test_table_3
[0m15:39:13.104135 [info ] [Thread-2  ]: 3 of 3 SKIP relation featuredata3405_scratch.test_table_3 ...................... [[33mSKIP[0m]
[0m15:39:13.104998 [debug] [Thread-2  ]: Finished running node model.hu_dw_datawarehouse.test_table_3
[0m15:39:13.107219 [debug] [MainThread]: Acquiring new postgres connection "master"
[0m15:39:13.107703 [debug] [MainThread]: Using postgres connection "master"
[0m15:39:13.108003 [debug] [MainThread]: On master: BEGIN
[0m15:39:13.108259 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m15:39:14.077429 [debug] [MainThread]: SQL status: BEGIN in 0.97 seconds
[0m15:39:14.078261 [debug] [MainThread]: On master: COMMIT
[0m15:39:14.078835 [debug] [MainThread]: Using postgres connection "master"
[0m15:39:14.079333 [debug] [MainThread]: On master: COMMIT
[0m15:39:14.198752 [debug] [MainThread]: SQL status: COMMIT in 0.12 seconds
[0m15:39:14.199666 [debug] [MainThread]: On master: Close
[0m15:39:14.201475 [info ] [MainThread]: 
[0m15:39:14.202518 [info ] [MainThread]: Finished running 3 table models in 0 hours 0 minutes and 8.40 seconds (8.40s).
[0m15:39:14.203139 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:39:14.203477 [debug] [MainThread]: Connection 'model.hu_dw_datawarehouse.test_table_1' was properly closed.
[0m15:39:14.203803 [debug] [MainThread]: Connection 'model.hu_dw_datawarehouse.test_table_2' was properly closed.
[0m15:39:14.216102 [info ] [MainThread]: 
[0m15:39:14.216740 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m15:39:14.217290 [info ] [MainThread]: 
[0m15:39:14.217760 [error] [MainThread]: [33mDatabase Error in model test_table_2 (models/test_table_2.sql)[0m
[0m15:39:14.218220 [error] [MainThread]:   column "smth" does not exist
[0m15:39:14.218763 [error] [MainThread]:   LINE 14: where smth = 0
[0m15:39:14.219214 [error] [MainThread]:                  ^
[0m15:39:14.219677 [error] [MainThread]:   compiled SQL at target/run/hu_dw_datawarehouse/models/test_table_2.sql
[0m15:39:14.220345 [info ] [MainThread]: 
[0m15:39:14.220903 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=1 SKIP=1 TOTAL=3
[0m15:39:14.221520 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa3dff955b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa3e0030760>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa3dffc6dc0>]}
[0m15:39:14.221975 [debug] [MainThread]: Flushing usage events


============================== 2022-10-10 15:39:29.808195 | 3217d9dd-5136-4fca-a8d0-f2c72a2dbdf1 ==============================
[0m15:39:29.808241 [info ] [MainThread]: Running with dbt=1.2.2
[0m15:39:29.809160 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/okolesnikov/Documents/health-union/Repos/DATA-3405-test', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'target': 'postgres', 'select': ['+test_table_3'], 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m15:39:29.809349 [debug] [MainThread]: Tracking: tracking
[0m15:39:29.829304 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbe33719e20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbe33727fd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbe33725be0>]}
[0m15:39:29.872202 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m15:39:29.872660 [debug] [MainThread]: Partial parsing: updated file: hu_dw_datawarehouse://models/test_table_2.sql
[0m15:39:29.915055 [debug] [MainThread]: 1603: static parser failed on test_table_2.sql
[0m15:39:29.928538 [debug] [MainThread]: 1602: parser fallback to jinja rendering on test_table_2.sql
[0m15:39:29.937866 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '3217d9dd-5136-4fca-a8d0-f2c72a2dbdf1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbe337aeaf0>]}
[0m15:39:29.943660 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '3217d9dd-5136-4fca-a8d0-f2c72a2dbdf1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbe337239a0>]}
[0m15:39:29.944035 [info ] [MainThread]: Found 3 models, 0 tests, 0 snapshots, 0 analyses, 256 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics
[0m15:39:29.944404 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3217d9dd-5136-4fca-a8d0-f2c72a2dbdf1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbe3388fc10>]}
[0m15:39:29.945715 [info ] [MainThread]: 
[0m15:39:29.946290 [debug] [MainThread]: Acquiring new postgres connection "master"
[0m15:39:29.947435 [debug] [ThreadPool]: Acquiring new postgres connection "list_defaultdb"
[0m15:39:29.959288 [debug] [ThreadPool]: Using postgres connection "list_defaultdb"
[0m15:39:29.959527 [debug] [ThreadPool]: On list_defaultdb: /* {"app": "dbt", "dbt_version": "1.2.2", "profile_name": "default", "target_name": "postgres", "connection_name": "list_defaultdb"} */

    select distinct nspname from pg_namespace
  
[0m15:39:29.959665 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:39:31.011903 [debug] [ThreadPool]: SQL status: SELECT 5 in 1.05 seconds
[0m15:39:31.015964 [debug] [ThreadPool]: On list_defaultdb: Close
[0m15:39:31.018773 [debug] [ThreadPool]: Acquiring new postgres connection "list_defaultdb_featuredata3405_scratch"
[0m15:39:31.030123 [debug] [ThreadPool]: Using postgres connection "list_defaultdb_featuredata3405_scratch"
[0m15:39:31.030585 [debug] [ThreadPool]: On list_defaultdb_featuredata3405_scratch: BEGIN
[0m15:39:31.030832 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:39:32.014693 [debug] [ThreadPool]: SQL status: BEGIN in 0.98 seconds
[0m15:39:32.015475 [debug] [ThreadPool]: Using postgres connection "list_defaultdb_featuredata3405_scratch"
[0m15:39:32.015986 [debug] [ThreadPool]: On list_defaultdb_featuredata3405_scratch: /* {"app": "dbt", "dbt_version": "1.2.2", "profile_name": "default", "target_name": "postgres", "connection_name": "list_defaultdb_featuredata3405_scratch"} */
select
      'defaultdb' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'featuredata3405_scratch'
    union all
    select
      'defaultdb' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'featuredata3405_scratch'
  
[0m15:39:32.141585 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.13 seconds
[0m15:39:32.145698 [debug] [ThreadPool]: On list_defaultdb_featuredata3405_scratch: ROLLBACK
[0m15:39:32.270559 [debug] [ThreadPool]: On list_defaultdb_featuredata3405_scratch: Close
[0m15:39:32.284432 [debug] [MainThread]: Using postgres connection "master"
[0m15:39:32.284877 [debug] [MainThread]: On master: BEGIN
[0m15:39:32.285160 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:39:33.339769 [debug] [MainThread]: SQL status: BEGIN in 1.05 seconds
[0m15:39:33.341218 [debug] [MainThread]: Using postgres connection "master"
[0m15:39:33.342024 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.2.2", "profile_name": "default", "target_name": "postgres", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m15:39:33.497655 [debug] [MainThread]: SQL status: SELECT 0 in 0.14 seconds
[0m15:39:33.501678 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3217d9dd-5136-4fca-a8d0-f2c72a2dbdf1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbe331750a0>]}
[0m15:39:33.502438 [debug] [MainThread]: On master: ROLLBACK
[0m15:39:33.636645 [debug] [MainThread]: Using postgres connection "master"
[0m15:39:33.637437 [debug] [MainThread]: On master: BEGIN
[0m15:39:33.897690 [debug] [MainThread]: SQL status: BEGIN in 0.26 seconds
[0m15:39:33.898276 [debug] [MainThread]: On master: COMMIT
[0m15:39:33.898666 [debug] [MainThread]: Using postgres connection "master"
[0m15:39:33.898995 [debug] [MainThread]: On master: COMMIT
[0m15:39:34.026142 [debug] [MainThread]: SQL status: COMMIT in 0.13 seconds
[0m15:39:34.027030 [debug] [MainThread]: On master: Close
[0m15:39:34.028617 [info ] [MainThread]: Concurrency: 4 threads (target='postgres')
[0m15:39:34.029390 [info ] [MainThread]: 
[0m15:39:34.036865 [debug] [Thread-1  ]: Began running node model.hu_dw_datawarehouse.test_table_1
[0m15:39:34.037490 [info ] [Thread-1  ]: 1 of 3 START table model featuredata3405_scratch.test_table_1 .................. [RUN]
[0m15:39:34.038426 [debug] [Thread-1  ]: Acquiring new postgres connection "model.hu_dw_datawarehouse.test_table_1"
[0m15:39:34.038796 [debug] [Thread-1  ]: Began compiling node model.hu_dw_datawarehouse.test_table_1
[0m15:39:34.039122 [debug] [Thread-1  ]: Compiling model.hu_dw_datawarehouse.test_table_1
[0m15:39:34.044641 [debug] [Thread-1  ]: Writing injected SQL for node "model.hu_dw_datawarehouse.test_table_1"
[0m15:39:34.045549 [debug] [Thread-1  ]: finished collecting timing info
[0m15:39:34.045870 [debug] [Thread-1  ]: Began executing node model.hu_dw_datawarehouse.test_table_1
[0m15:39:34.093339 [debug] [Thread-1  ]: Writing runtime SQL for node "model.hu_dw_datawarehouse.test_table_1"
[0m15:39:34.093917 [debug] [Thread-1  ]: Using postgres connection "model.hu_dw_datawarehouse.test_table_1"
[0m15:39:34.094075 [debug] [Thread-1  ]: On model.hu_dw_datawarehouse.test_table_1: BEGIN
[0m15:39:34.094190 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m15:39:35.061128 [debug] [Thread-1  ]: SQL status: BEGIN in 0.97 seconds
[0m15:39:35.061793 [debug] [Thread-1  ]: Using postgres connection "model.hu_dw_datawarehouse.test_table_1"
[0m15:39:35.062167 [debug] [Thread-1  ]: On model.hu_dw_datawarehouse.test_table_1: /* {"app": "dbt", "dbt_version": "1.2.2", "profile_name": "default", "target_name": "postgres", "node_id": "model.hu_dw_datawarehouse.test_table_1"} */


  create  table "defaultdb"."featuredata3405_scratch"."test_table_1__dbt_tmp"
  as (
    

SELECT 
col
, POWER(col,2) AS col_power_2
FROM
"defaultdb"."featuredata3405_scratch"."source_table"
  );
[0m15:39:35.184434 [debug] [Thread-1  ]: SQL status: SELECT 5 in 0.12 seconds
[0m15:39:35.199785 [debug] [Thread-1  ]: Using postgres connection "model.hu_dw_datawarehouse.test_table_1"
[0m15:39:35.200210 [debug] [Thread-1  ]: On model.hu_dw_datawarehouse.test_table_1: /* {"app": "dbt", "dbt_version": "1.2.2", "profile_name": "default", "target_name": "postgres", "node_id": "model.hu_dw_datawarehouse.test_table_1"} */
alter table "defaultdb"."featuredata3405_scratch"."test_table_1" rename to "test_table_1__dbt_backup"
[0m15:39:35.319829 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.12 seconds
[0m15:39:35.325861 [debug] [Thread-1  ]: Using postgres connection "model.hu_dw_datawarehouse.test_table_1"
[0m15:39:35.326346 [debug] [Thread-1  ]: On model.hu_dw_datawarehouse.test_table_1: /* {"app": "dbt", "dbt_version": "1.2.2", "profile_name": "default", "target_name": "postgres", "node_id": "model.hu_dw_datawarehouse.test_table_1"} */
alter table "defaultdb"."featuredata3405_scratch"."test_table_1__dbt_tmp" rename to "test_table_1"
[0m15:39:35.447023 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.12 seconds
[0m15:39:35.491724 [debug] [Thread-1  ]: On model.hu_dw_datawarehouse.test_table_1: COMMIT
[0m15:39:35.491977 [debug] [Thread-1  ]: Using postgres connection "model.hu_dw_datawarehouse.test_table_1"
[0m15:39:35.492127 [debug] [Thread-1  ]: On model.hu_dw_datawarehouse.test_table_1: COMMIT
[0m15:39:35.611145 [debug] [Thread-1  ]: SQL status: COMMIT in 0.12 seconds
[0m15:39:35.623888 [debug] [Thread-1  ]: Using postgres connection "model.hu_dw_datawarehouse.test_table_1"
[0m15:39:35.624310 [debug] [Thread-1  ]: On model.hu_dw_datawarehouse.test_table_1: /* {"app": "dbt", "dbt_version": "1.2.2", "profile_name": "default", "target_name": "postgres", "node_id": "model.hu_dw_datawarehouse.test_table_1"} */
drop table if exists "defaultdb"."featuredata3405_scratch"."test_table_1__dbt_backup" cascade
[0m15:39:35.744928 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.12 seconds
[0m15:39:35.748833 [debug] [Thread-1  ]: finished collecting timing info
[0m15:39:35.749313 [debug] [Thread-1  ]: On model.hu_dw_datawarehouse.test_table_1: Close
[0m15:39:35.750532 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3217d9dd-5136-4fca-a8d0-f2c72a2dbdf1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbe33a49250>]}
[0m15:39:35.751386 [info ] [Thread-1  ]: 1 of 3 OK created table model featuredata3405_scratch.test_table_1 ............. [[32mSELECT 5[0m in 1.71s]
[0m15:39:35.752406 [debug] [Thread-1  ]: Finished running node model.hu_dw_datawarehouse.test_table_1
[0m15:39:35.753889 [debug] [Thread-3  ]: Began running node model.hu_dw_datawarehouse.test_table_2
[0m15:39:35.754762 [info ] [Thread-3  ]: 2 of 3 START table model featuredata3405_scratch.test_table_2 .................. [RUN]
[0m15:39:35.755790 [debug] [Thread-3  ]: Acquiring new postgres connection "model.hu_dw_datawarehouse.test_table_2"
[0m15:39:35.756200 [debug] [Thread-3  ]: Began compiling node model.hu_dw_datawarehouse.test_table_2
[0m15:39:35.756545 [debug] [Thread-3  ]: Compiling model.hu_dw_datawarehouse.test_table_2
[0m15:39:35.762052 [debug] [Thread-3  ]: Writing injected SQL for node "model.hu_dw_datawarehouse.test_table_2"
[0m15:39:35.762951 [debug] [Thread-3  ]: finished collecting timing info
[0m15:39:35.763430 [debug] [Thread-3  ]: Began executing node model.hu_dw_datawarehouse.test_table_2
[0m15:39:35.771384 [debug] [Thread-3  ]: Writing runtime SQL for node "model.hu_dw_datawarehouse.test_table_2"
[0m15:39:35.772224 [debug] [Thread-3  ]: Using postgres connection "model.hu_dw_datawarehouse.test_table_2"
[0m15:39:35.772532 [debug] [Thread-3  ]: On model.hu_dw_datawarehouse.test_table_2: BEGIN
[0m15:39:35.772824 [debug] [Thread-3  ]: Opening a new connection, currently in state init
[0m15:39:36.756481 [debug] [Thread-3  ]: SQL status: BEGIN in 0.98 seconds
[0m15:39:36.757261 [debug] [Thread-3  ]: Using postgres connection "model.hu_dw_datawarehouse.test_table_2"
[0m15:39:36.757767 [debug] [Thread-3  ]: On model.hu_dw_datawarehouse.test_table_2: /* {"app": "dbt", "dbt_version": "1.2.2", "profile_name": "default", "target_name": "postgres", "node_id": "model.hu_dw_datawarehouse.test_table_2"} */


  create  table "defaultdb"."featuredata3405_scratch"."test_table_2__dbt_tmp"
  as (
    

SELECT 
col
, col_power_2
, POWER(col,3) AS col_power_3
FROM
"defaultdb"."featuredata3405_scratch"."test_table_1"
--where smth = 0
  );
[0m15:39:36.884681 [debug] [Thread-3  ]: SQL status: SELECT 5 in 0.13 seconds
[0m15:39:36.889637 [debug] [Thread-3  ]: Using postgres connection "model.hu_dw_datawarehouse.test_table_2"
[0m15:39:36.890006 [debug] [Thread-3  ]: On model.hu_dw_datawarehouse.test_table_2: /* {"app": "dbt", "dbt_version": "1.2.2", "profile_name": "default", "target_name": "postgres", "node_id": "model.hu_dw_datawarehouse.test_table_2"} */
alter table "defaultdb"."featuredata3405_scratch"."test_table_2" rename to "test_table_2__dbt_backup"
[0m15:39:37.009061 [debug] [Thread-3  ]: SQL status: ALTER TABLE in 0.12 seconds
[0m15:39:37.012518 [debug] [Thread-3  ]: Using postgres connection "model.hu_dw_datawarehouse.test_table_2"
[0m15:39:37.012778 [debug] [Thread-3  ]: On model.hu_dw_datawarehouse.test_table_2: /* {"app": "dbt", "dbt_version": "1.2.2", "profile_name": "default", "target_name": "postgres", "node_id": "model.hu_dw_datawarehouse.test_table_2"} */
alter table "defaultdb"."featuredata3405_scratch"."test_table_2__dbt_tmp" rename to "test_table_2"
[0m15:39:37.132329 [debug] [Thread-3  ]: SQL status: ALTER TABLE in 0.12 seconds
[0m15:39:37.136616 [debug] [Thread-3  ]: On model.hu_dw_datawarehouse.test_table_2: COMMIT
[0m15:39:37.136936 [debug] [Thread-3  ]: Using postgres connection "model.hu_dw_datawarehouse.test_table_2"
[0m15:39:37.137171 [debug] [Thread-3  ]: On model.hu_dw_datawarehouse.test_table_2: COMMIT
[0m15:39:37.260001 [debug] [Thread-3  ]: SQL status: COMMIT in 0.12 seconds
[0m15:39:37.265598 [debug] [Thread-3  ]: Using postgres connection "model.hu_dw_datawarehouse.test_table_2"
[0m15:39:37.266031 [debug] [Thread-3  ]: On model.hu_dw_datawarehouse.test_table_2: /* {"app": "dbt", "dbt_version": "1.2.2", "profile_name": "default", "target_name": "postgres", "node_id": "model.hu_dw_datawarehouse.test_table_2"} */
drop table if exists "defaultdb"."featuredata3405_scratch"."test_table_2__dbt_backup" cascade
[0m15:39:37.388275 [debug] [Thread-3  ]: SQL status: DROP TABLE in 0.12 seconds
[0m15:39:37.392069 [debug] [Thread-3  ]: finished collecting timing info
[0m15:39:37.392690 [debug] [Thread-3  ]: On model.hu_dw_datawarehouse.test_table_2: Close
[0m15:39:37.393993 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3217d9dd-5136-4fca-a8d0-f2c72a2dbdf1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbe33a4bbe0>]}
[0m15:39:37.394963 [info ] [Thread-3  ]: 2 of 3 OK created table model featuredata3405_scratch.test_table_2 ............. [[32mSELECT 5[0m in 1.64s]
[0m15:39:37.396107 [debug] [Thread-3  ]: Finished running node model.hu_dw_datawarehouse.test_table_2
[0m15:39:37.397796 [debug] [Thread-2  ]: Began running node model.hu_dw_datawarehouse.test_table_3
[0m15:39:37.398610 [info ] [Thread-2  ]: 3 of 3 START table model featuredata3405_scratch.test_table_3 .................. [RUN]
[0m15:39:37.400019 [debug] [Thread-2  ]: Acquiring new postgres connection "model.hu_dw_datawarehouse.test_table_3"
[0m15:39:37.400481 [debug] [Thread-2  ]: Began compiling node model.hu_dw_datawarehouse.test_table_3
[0m15:39:37.400989 [debug] [Thread-2  ]: Compiling model.hu_dw_datawarehouse.test_table_3
[0m15:39:37.406270 [debug] [Thread-2  ]: Writing injected SQL for node "model.hu_dw_datawarehouse.test_table_3"
[0m15:39:37.407199 [debug] [Thread-2  ]: finished collecting timing info
[0m15:39:37.407648 [debug] [Thread-2  ]: Began executing node model.hu_dw_datawarehouse.test_table_3
[0m15:39:37.413995 [debug] [Thread-2  ]: Writing runtime SQL for node "model.hu_dw_datawarehouse.test_table_3"
[0m15:39:37.414824 [debug] [Thread-2  ]: Using postgres connection "model.hu_dw_datawarehouse.test_table_3"
[0m15:39:37.415104 [debug] [Thread-2  ]: On model.hu_dw_datawarehouse.test_table_3: BEGIN
[0m15:39:37.415298 [debug] [Thread-2  ]: Opening a new connection, currently in state init
[0m15:39:38.398902 [debug] [Thread-2  ]: SQL status: BEGIN in 0.98 seconds
[0m15:39:38.399716 [debug] [Thread-2  ]: Using postgres connection "model.hu_dw_datawarehouse.test_table_3"
[0m15:39:38.400254 [debug] [Thread-2  ]: On model.hu_dw_datawarehouse.test_table_3: /* {"app": "dbt", "dbt_version": "1.2.2", "profile_name": "default", "target_name": "postgres", "node_id": "model.hu_dw_datawarehouse.test_table_3"} */


  create  table "defaultdb"."featuredata3405_scratch"."test_table_3__dbt_tmp"
  as (
    

SELECT 
col
, col_power_2
, col_power_3
, POWER(col,4) AS col_power_4
FROM
"defaultdb"."featuredata3405_scratch"."test_table_2"
  );
[0m15:39:38.523446 [debug] [Thread-2  ]: SQL status: SELECT 5 in 0.12 seconds
[0m15:39:38.530850 [debug] [Thread-2  ]: Using postgres connection "model.hu_dw_datawarehouse.test_table_3"
[0m15:39:38.531328 [debug] [Thread-2  ]: On model.hu_dw_datawarehouse.test_table_3: /* {"app": "dbt", "dbt_version": "1.2.2", "profile_name": "default", "target_name": "postgres", "node_id": "model.hu_dw_datawarehouse.test_table_3"} */
alter table "defaultdb"."featuredata3405_scratch"."test_table_3__dbt_tmp" rename to "test_table_3"
[0m15:39:38.651808 [debug] [Thread-2  ]: SQL status: ALTER TABLE in 0.12 seconds
[0m15:39:38.657634 [debug] [Thread-2  ]: On model.hu_dw_datawarehouse.test_table_3: COMMIT
[0m15:39:38.658122 [debug] [Thread-2  ]: Using postgres connection "model.hu_dw_datawarehouse.test_table_3"
[0m15:39:38.658493 [debug] [Thread-2  ]: On model.hu_dw_datawarehouse.test_table_3: COMMIT
[0m15:39:38.779459 [debug] [Thread-2  ]: SQL status: COMMIT in 0.12 seconds
[0m15:39:38.785150 [debug] [Thread-2  ]: Using postgres connection "model.hu_dw_datawarehouse.test_table_3"
[0m15:39:38.785601 [debug] [Thread-2  ]: On model.hu_dw_datawarehouse.test_table_3: /* {"app": "dbt", "dbt_version": "1.2.2", "profile_name": "default", "target_name": "postgres", "node_id": "model.hu_dw_datawarehouse.test_table_3"} */
drop table if exists "defaultdb"."featuredata3405_scratch"."test_table_3__dbt_backup" cascade
[0m15:39:38.906693 [debug] [Thread-2  ]: SQL status: DROP TABLE in 0.12 seconds
[0m15:39:38.910562 [debug] [Thread-2  ]: finished collecting timing info
[0m15:39:38.911038 [debug] [Thread-2  ]: On model.hu_dw_datawarehouse.test_table_3: Close
[0m15:39:38.912307 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3217d9dd-5136-4fca-a8d0-f2c72a2dbdf1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbe32ee1760>]}
[0m15:39:38.913173 [info ] [Thread-2  ]: 3 of 3 OK created table model featuredata3405_scratch.test_table_3 ............. [[32mSELECT 5[0m in 1.51s]
[0m15:39:38.914370 [debug] [Thread-2  ]: Finished running node model.hu_dw_datawarehouse.test_table_3
[0m15:39:38.917361 [debug] [MainThread]: Acquiring new postgres connection "master"
[0m15:39:38.917844 [debug] [MainThread]: Using postgres connection "master"
[0m15:39:38.918146 [debug] [MainThread]: On master: BEGIN
[0m15:39:38.918404 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m15:39:39.915794 [debug] [MainThread]: SQL status: BEGIN in 1.0 seconds
[0m15:39:39.916758 [debug] [MainThread]: On master: COMMIT
[0m15:39:39.917449 [debug] [MainThread]: Using postgres connection "master"
[0m15:39:39.917965 [debug] [MainThread]: On master: COMMIT
[0m15:39:40.043981 [debug] [MainThread]: SQL status: COMMIT in 0.13 seconds
[0m15:39:40.045234 [debug] [MainThread]: On master: Close
[0m15:39:40.047127 [info ] [MainThread]: 
[0m15:39:40.047968 [info ] [MainThread]: Finished running 3 table models in 0 hours 0 minutes and 10.10 seconds (10.10s).
[0m15:39:40.048603 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:39:40.048983 [debug] [MainThread]: Connection 'model.hu_dw_datawarehouse.test_table_1' was properly closed.
[0m15:39:40.049338 [debug] [MainThread]: Connection 'model.hu_dw_datawarehouse.test_table_2' was properly closed.
[0m15:39:40.049668 [debug] [MainThread]: Connection 'model.hu_dw_datawarehouse.test_table_3' was properly closed.
[0m15:39:40.061722 [info ] [MainThread]: 
[0m15:39:40.062236 [info ] [MainThread]: [32mCompleted successfully[0m
[0m15:39:40.062730 [info ] [MainThread]: 
[0m15:39:40.063171 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m15:39:40.063777 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbe337becd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbe338a4880>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbe338d0b50>]}
[0m15:39:40.064276 [debug] [MainThread]: Flushing usage events


============================== 2022-10-10 15:47:43.846012 | 8a5bc855-69e7-4b29-97ff-08e0ca3b7552 ==============================
[0m15:47:43.846049 [info ] [MainThread]: Running with dbt=1.2.2
[0m15:47:43.847526 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/okolesnikov/Documents/health-union/Repos/DATA-3405-test', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'target': 'postgres', 'select': ['+test_table_3'], 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m15:47:43.848135 [debug] [MainThread]: Tracking: tracking
[0m15:47:43.869535 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8face23940>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8face238e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8face25910>]}
[0m15:47:43.934562 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m15:47:43.937274 [debug] [MainThread]: Partial parsing: updated file: hu_dw_datawarehouse://models/test_table_2.sql
[0m15:47:43.981225 [debug] [MainThread]: 1603: static parser failed on test_table_2.sql
[0m15:47:43.996069 [debug] [MainThread]: 1602: parser fallback to jinja rendering on test_table_2.sql
[0m15:47:44.004585 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '8a5bc855-69e7-4b29-97ff-08e0ca3b7552', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8faceacf40>]}
[0m15:47:44.010176 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '8a5bc855-69e7-4b29-97ff-08e0ca3b7552', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8faced3f10>]}
[0m15:47:44.010660 [info ] [MainThread]: Found 3 models, 0 tests, 0 snapshots, 0 analyses, 256 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics
[0m15:47:44.011042 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8a5bc855-69e7-4b29-97ff-08e0ca3b7552', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8facc6dd00>]}
[0m15:47:44.012284 [info ] [MainThread]: 
[0m15:47:44.012840 [debug] [MainThread]: Acquiring new postgres connection "master"
[0m15:47:44.013969 [debug] [ThreadPool]: Acquiring new postgres connection "list_defaultdb"
[0m15:47:44.025550 [debug] [ThreadPool]: Using postgres connection "list_defaultdb"
[0m15:47:44.025919 [debug] [ThreadPool]: On list_defaultdb: /* {"app": "dbt", "dbt_version": "1.2.2", "profile_name": "default", "target_name": "postgres", "connection_name": "list_defaultdb"} */

    select distinct nspname from pg_namespace
  
[0m15:47:44.026158 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:47:45.168404 [debug] [ThreadPool]: SQL status: SELECT 5 in 1.14 seconds
[0m15:47:45.170047 [debug] [ThreadPool]: On list_defaultdb: Close
[0m15:47:45.172021 [debug] [ThreadPool]: Acquiring new postgres connection "list_defaultdb_featuredata3405_scratch"
[0m15:47:45.179122 [debug] [ThreadPool]: Using postgres connection "list_defaultdb_featuredata3405_scratch"
[0m15:47:45.179446 [debug] [ThreadPool]: On list_defaultdb_featuredata3405_scratch: BEGIN
[0m15:47:45.179659 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:47:46.144932 [debug] [ThreadPool]: SQL status: BEGIN in 0.97 seconds
[0m15:47:46.145704 [debug] [ThreadPool]: Using postgres connection "list_defaultdb_featuredata3405_scratch"
[0m15:47:46.146205 [debug] [ThreadPool]: On list_defaultdb_featuredata3405_scratch: /* {"app": "dbt", "dbt_version": "1.2.2", "profile_name": "default", "target_name": "postgres", "connection_name": "list_defaultdb_featuredata3405_scratch"} */
select
      'defaultdb' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'featuredata3405_scratch'
    union all
    select
      'defaultdb' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'featuredata3405_scratch'
  
[0m15:47:46.276237 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.13 seconds
[0m15:47:46.280202 [debug] [ThreadPool]: On list_defaultdb_featuredata3405_scratch: ROLLBACK
[0m15:47:46.399484 [debug] [ThreadPool]: On list_defaultdb_featuredata3405_scratch: Close
[0m15:47:46.411877 [debug] [MainThread]: Using postgres connection "master"
[0m15:47:46.412283 [debug] [MainThread]: On master: BEGIN
[0m15:47:46.412552 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:47:47.391109 [debug] [MainThread]: SQL status: BEGIN in 0.98 seconds
[0m15:47:47.391842 [debug] [MainThread]: Using postgres connection "master"
[0m15:47:47.392335 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.2.2", "profile_name": "default", "target_name": "postgres", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m15:47:47.518254 [debug] [MainThread]: SQL status: SELECT 0 in 0.13 seconds
[0m15:47:47.522072 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8a5bc855-69e7-4b29-97ff-08e0ca3b7552', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8fac8acee0>]}
[0m15:47:47.522781 [debug] [MainThread]: On master: ROLLBACK
[0m15:47:47.641405 [debug] [MainThread]: Using postgres connection "master"
[0m15:47:47.641684 [debug] [MainThread]: On master: BEGIN
[0m15:47:47.883941 [debug] [MainThread]: SQL status: BEGIN in 0.24 seconds
[0m15:47:47.884791 [debug] [MainThread]: On master: COMMIT
[0m15:47:47.885368 [debug] [MainThread]: Using postgres connection "master"
[0m15:47:47.885834 [debug] [MainThread]: On master: COMMIT
[0m15:47:48.004899 [debug] [MainThread]: SQL status: COMMIT in 0.12 seconds
[0m15:47:48.005839 [debug] [MainThread]: On master: Close
[0m15:47:48.007451 [info ] [MainThread]: Concurrency: 4 threads (target='postgres')
[0m15:47:48.008441 [info ] [MainThread]: 
[0m15:47:48.015843 [debug] [Thread-1  ]: Began running node model.hu_dw_datawarehouse.test_table_1
[0m15:47:48.016492 [info ] [Thread-1  ]: 1 of 3 START table model featuredata3405_scratch.test_table_1 .................. [RUN]
[0m15:47:48.017445 [debug] [Thread-1  ]: Acquiring new postgres connection "model.hu_dw_datawarehouse.test_table_1"
[0m15:47:48.017821 [debug] [Thread-1  ]: Began compiling node model.hu_dw_datawarehouse.test_table_1
[0m15:47:48.018134 [debug] [Thread-1  ]: Compiling model.hu_dw_datawarehouse.test_table_1
[0m15:47:48.024240 [debug] [Thread-1  ]: Writing injected SQL for node "model.hu_dw_datawarehouse.test_table_1"
[0m15:47:48.025270 [debug] [Thread-1  ]: finished collecting timing info
[0m15:47:48.025684 [debug] [Thread-1  ]: Began executing node model.hu_dw_datawarehouse.test_table_1
[0m15:47:48.076387 [debug] [Thread-1  ]: Writing runtime SQL for node "model.hu_dw_datawarehouse.test_table_1"
[0m15:47:48.077047 [debug] [Thread-1  ]: Using postgres connection "model.hu_dw_datawarehouse.test_table_1"
[0m15:47:48.077244 [debug] [Thread-1  ]: On model.hu_dw_datawarehouse.test_table_1: BEGIN
[0m15:47:48.077456 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m15:47:49.079782 [debug] [Thread-1  ]: SQL status: BEGIN in 1.0 seconds
[0m15:47:49.080611 [debug] [Thread-1  ]: Using postgres connection "model.hu_dw_datawarehouse.test_table_1"
[0m15:47:49.081120 [debug] [Thread-1  ]: On model.hu_dw_datawarehouse.test_table_1: /* {"app": "dbt", "dbt_version": "1.2.2", "profile_name": "default", "target_name": "postgres", "node_id": "model.hu_dw_datawarehouse.test_table_1"} */


  create  table "defaultdb"."featuredata3405_scratch"."test_table_1__dbt_tmp"
  as (
    

SELECT 
col
, POWER(col,2) AS col_power_2
FROM
"defaultdb"."featuredata3405_scratch"."source_table"
  );
[0m15:47:49.243802 [debug] [Thread-1  ]: SQL status: SELECT 5 in 0.16 seconds
[0m15:47:49.255945 [debug] [Thread-1  ]: Using postgres connection "model.hu_dw_datawarehouse.test_table_1"
[0m15:47:49.256320 [debug] [Thread-1  ]: On model.hu_dw_datawarehouse.test_table_1: /* {"app": "dbt", "dbt_version": "1.2.2", "profile_name": "default", "target_name": "postgres", "node_id": "model.hu_dw_datawarehouse.test_table_1"} */
alter table "defaultdb"."featuredata3405_scratch"."test_table_1" rename to "test_table_1__dbt_backup"
[0m15:47:49.427343 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.17 seconds
[0m15:47:49.429892 [debug] [Thread-1  ]: Using postgres connection "model.hu_dw_datawarehouse.test_table_1"
[0m15:47:49.430097 [debug] [Thread-1  ]: On model.hu_dw_datawarehouse.test_table_1: /* {"app": "dbt", "dbt_version": "1.2.2", "profile_name": "default", "target_name": "postgres", "node_id": "model.hu_dw_datawarehouse.test_table_1"} */
alter table "defaultdb"."featuredata3405_scratch"."test_table_1__dbt_tmp" rename to "test_table_1"
[0m15:47:49.613321 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.18 seconds
[0m15:47:49.636936 [debug] [Thread-1  ]: On model.hu_dw_datawarehouse.test_table_1: COMMIT
[0m15:47:49.637181 [debug] [Thread-1  ]: Using postgres connection "model.hu_dw_datawarehouse.test_table_1"
[0m15:47:49.637322 [debug] [Thread-1  ]: On model.hu_dw_datawarehouse.test_table_1: COMMIT
[0m15:47:49.829159 [debug] [Thread-1  ]: SQL status: COMMIT in 0.19 seconds
[0m15:47:49.834479 [debug] [Thread-1  ]: Using postgres connection "model.hu_dw_datawarehouse.test_table_1"
[0m15:47:49.834833 [debug] [Thread-1  ]: On model.hu_dw_datawarehouse.test_table_1: /* {"app": "dbt", "dbt_version": "1.2.2", "profile_name": "default", "target_name": "postgres", "node_id": "model.hu_dw_datawarehouse.test_table_1"} */
drop table if exists "defaultdb"."featuredata3405_scratch"."test_table_1__dbt_backup" cascade
[0m15:47:50.037721 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.2 seconds
[0m15:47:50.041620 [debug] [Thread-1  ]: finished collecting timing info
[0m15:47:50.042114 [debug] [Thread-1  ]: On model.hu_dw_datawarehouse.test_table_1: Close
[0m15:47:50.043322 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8a5bc855-69e7-4b29-97ff-08e0ca3b7552', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8fad13c0d0>]}
[0m15:47:50.044125 [info ] [Thread-1  ]: 1 of 3 OK created table model featuredata3405_scratch.test_table_1 ............. [[32mSELECT 5[0m in 2.03s]
[0m15:47:50.045050 [debug] [Thread-1  ]: Finished running node model.hu_dw_datawarehouse.test_table_1
[0m15:47:50.046595 [debug] [Thread-3  ]: Began running node model.hu_dw_datawarehouse.test_table_2
[0m15:47:50.047464 [info ] [Thread-3  ]: 2 of 3 START table model featuredata3405_scratch.test_table_2 .................. [RUN]
[0m15:47:50.048632 [debug] [Thread-3  ]: Acquiring new postgres connection "model.hu_dw_datawarehouse.test_table_2"
[0m15:47:50.049032 [debug] [Thread-3  ]: Began compiling node model.hu_dw_datawarehouse.test_table_2
[0m15:47:50.049358 [debug] [Thread-3  ]: Compiling model.hu_dw_datawarehouse.test_table_2
[0m15:47:50.054737 [debug] [Thread-3  ]: Writing injected SQL for node "model.hu_dw_datawarehouse.test_table_2"
[0m15:47:50.055788 [debug] [Thread-3  ]: finished collecting timing info
[0m15:47:50.056231 [debug] [Thread-3  ]: Began executing node model.hu_dw_datawarehouse.test_table_2
[0m15:47:50.063794 [debug] [Thread-3  ]: Writing runtime SQL for node "model.hu_dw_datawarehouse.test_table_2"
[0m15:47:50.064566 [debug] [Thread-3  ]: Using postgres connection "model.hu_dw_datawarehouse.test_table_2"
[0m15:47:50.064804 [debug] [Thread-3  ]: On model.hu_dw_datawarehouse.test_table_2: BEGIN
[0m15:47:50.064977 [debug] [Thread-3  ]: Opening a new connection, currently in state init
[0m15:47:52.147781 [debug] [Thread-3  ]: SQL status: BEGIN in 2.08 seconds
[0m15:47:52.148591 [debug] [Thread-3  ]: Using postgres connection "model.hu_dw_datawarehouse.test_table_2"
[0m15:47:52.149128 [debug] [Thread-3  ]: On model.hu_dw_datawarehouse.test_table_2: /* {"app": "dbt", "dbt_version": "1.2.2", "profile_name": "default", "target_name": "postgres", "node_id": "model.hu_dw_datawarehouse.test_table_2"} */


  create  table "defaultdb"."featuredata3405_scratch"."test_table_2__dbt_tmp"
  as (
    

SELECT 
col
, col_power_2
, POWER(col,3) AS col_power_3
, 1/0
FROM
"defaultdb"."featuredata3405_scratch"."test_table_1"
  );
[0m15:47:52.359219 [debug] [Thread-3  ]: Postgres adapter: Postgres error: division by zero

[0m15:47:52.359707 [debug] [Thread-3  ]: On model.hu_dw_datawarehouse.test_table_2: ROLLBACK
[0m15:47:52.562204 [debug] [Thread-3  ]: finished collecting timing info
[0m15:47:52.562998 [debug] [Thread-3  ]: On model.hu_dw_datawarehouse.test_table_2: Close
[0m15:47:52.564794 [debug] [Thread-3  ]: Database Error in model test_table_2 (models/test_table_2.sql)
  division by zero
  compiled SQL at target/run/hu_dw_datawarehouse/models/test_table_2.sql
[0m15:47:52.565837 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8a5bc855-69e7-4b29-97ff-08e0ca3b7552', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8fad170250>]}
[0m15:47:52.566701 [error] [Thread-3  ]: 2 of 3 ERROR creating table model featuredata3405_scratch.test_table_2 ......... [[31mERROR[0m in 2.52s]
[0m15:47:52.567660 [debug] [Thread-3  ]: Finished running node model.hu_dw_datawarehouse.test_table_2
[0m15:47:52.568867 [debug] [Thread-2  ]: Began running node model.hu_dw_datawarehouse.test_table_3
[0m15:47:52.569669 [info ] [Thread-2  ]: 3 of 3 SKIP relation featuredata3405_scratch.test_table_3 ...................... [[33mSKIP[0m]
[0m15:47:52.570863 [debug] [Thread-2  ]: Finished running node model.hu_dw_datawarehouse.test_table_3
[0m15:47:52.573237 [debug] [MainThread]: Acquiring new postgres connection "master"
[0m15:47:52.573695 [debug] [MainThread]: Using postgres connection "master"
[0m15:47:52.573981 [debug] [MainThread]: On master: BEGIN
[0m15:47:52.574224 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m15:47:53.655190 [debug] [MainThread]: SQL status: BEGIN in 1.08 seconds
[0m15:47:53.656573 [debug] [MainThread]: On master: COMMIT
[0m15:47:53.657236 [debug] [MainThread]: Using postgres connection "master"
[0m15:47:53.657599 [debug] [MainThread]: On master: COMMIT
[0m15:47:53.784896 [debug] [MainThread]: SQL status: COMMIT in 0.13 seconds
[0m15:47:53.785826 [debug] [MainThread]: On master: Close
[0m15:47:53.787788 [info ] [MainThread]: 
[0m15:47:53.788866 [info ] [MainThread]: Finished running 3 table models in 0 hours 0 minutes and 9.77 seconds (9.77s).
[0m15:47:53.789488 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:47:53.789818 [debug] [MainThread]: Connection 'model.hu_dw_datawarehouse.test_table_1' was properly closed.
[0m15:47:53.790142 [debug] [MainThread]: Connection 'model.hu_dw_datawarehouse.test_table_2' was properly closed.
[0m15:47:53.801968 [info ] [MainThread]: 
[0m15:47:53.802506 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m15:47:53.803164 [info ] [MainThread]: 
[0m15:47:53.803625 [error] [MainThread]: [33mDatabase Error in model test_table_2 (models/test_table_2.sql)[0m
[0m15:47:53.804061 [error] [MainThread]:   division by zero
[0m15:47:53.804478 [error] [MainThread]:   compiled SQL at target/run/hu_dw_datawarehouse/models/test_table_2.sql
[0m15:47:53.808708 [info ] [MainThread]: 
[0m15:47:53.812181 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=1 SKIP=1 TOTAL=3
[0m15:47:53.813652 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8face79130>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8facfae490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8faced3580>]}
[0m15:47:53.814939 [debug] [MainThread]: Flushing usage events


============================== 2022-10-10 15:50:33.932437 | 92205e2d-cef8-45b0-b01c-15ea8e449f8d ==============================
[0m15:50:33.932495 [info ] [MainThread]: Running with dbt=1.2.2
[0m15:50:33.933216 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/okolesnikov/Documents/health-union/Repos/DATA-3405-test', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'target': 'postgres', 'select': ['+test_table_3'], 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m15:50:33.933426 [debug] [MainThread]: Tracking: tracking
[0m15:50:33.953416 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff9ff023670>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff9ff0238e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff9ff025910>]}
[0m15:50:33.995426 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m15:50:33.995653 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m15:50:34.002420 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '92205e2d-cef8-45b0-b01c-15ea8e449f8d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff9ff0990d0>]}
[0m15:50:34.008686 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '92205e2d-cef8-45b0-b01c-15ea8e449f8d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff9ff1ae0a0>]}
[0m15:50:34.009007 [info ] [MainThread]: Found 3 models, 0 tests, 0 snapshots, 0 analyses, 256 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics
[0m15:50:34.009289 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '92205e2d-cef8-45b0-b01c-15ea8e449f8d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff9ff1ae100>]}
[0m15:50:34.010781 [info ] [MainThread]: 
[0m15:50:34.011379 [debug] [MainThread]: Acquiring new postgres connection "master"
[0m15:50:34.012600 [debug] [ThreadPool]: Acquiring new postgres connection "list_defaultdb"
[0m15:50:34.054779 [debug] [ThreadPool]: Using postgres connection "list_defaultdb"
[0m15:50:34.055017 [debug] [ThreadPool]: On list_defaultdb: /* {"app": "dbt", "dbt_version": "1.2.2", "profile_name": "default", "target_name": "postgres", "connection_name": "list_defaultdb"} */

    select distinct nspname from pg_namespace
  
[0m15:50:34.055197 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:50:35.131680 [debug] [ThreadPool]: SQL status: SELECT 5 in 1.08 seconds
[0m15:50:35.133080 [debug] [ThreadPool]: On list_defaultdb: Close
[0m15:50:35.134459 [debug] [ThreadPool]: Acquiring new postgres connection "list_defaultdb_featuredata3405_scratch"
[0m15:50:35.140355 [debug] [ThreadPool]: Using postgres connection "list_defaultdb_featuredata3405_scratch"
[0m15:50:35.140592 [debug] [ThreadPool]: On list_defaultdb_featuredata3405_scratch: BEGIN
[0m15:50:35.140813 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:50:36.106720 [debug] [ThreadPool]: SQL status: BEGIN in 0.97 seconds
[0m15:50:36.107153 [debug] [ThreadPool]: Using postgres connection "list_defaultdb_featuredata3405_scratch"
[0m15:50:36.107441 [debug] [ThreadPool]: On list_defaultdb_featuredata3405_scratch: /* {"app": "dbt", "dbt_version": "1.2.2", "profile_name": "default", "target_name": "postgres", "connection_name": "list_defaultdb_featuredata3405_scratch"} */
select
      'defaultdb' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'featuredata3405_scratch'
    union all
    select
      'defaultdb' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'featuredata3405_scratch'
  
[0m15:50:36.229407 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.12 seconds
[0m15:50:36.232687 [debug] [ThreadPool]: On list_defaultdb_featuredata3405_scratch: ROLLBACK
[0m15:50:36.353267 [debug] [ThreadPool]: On list_defaultdb_featuredata3405_scratch: Close
[0m15:50:36.363346 [debug] [MainThread]: Using postgres connection "master"
[0m15:50:36.363745 [debug] [MainThread]: On master: BEGIN
[0m15:50:36.364017 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:50:37.338318 [debug] [MainThread]: SQL status: BEGIN in 0.97 seconds
[0m15:50:37.339103 [debug] [MainThread]: Using postgres connection "master"
[0m15:50:37.339619 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.2.2", "profile_name": "default", "target_name": "postgres", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m15:50:37.463904 [debug] [MainThread]: SQL status: SELECT 0 in 0.12 seconds
[0m15:50:37.467692 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '92205e2d-cef8-45b0-b01c-15ea8e449f8d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff9fd958b20>]}
[0m15:50:37.468431 [debug] [MainThread]: On master: ROLLBACK
[0m15:50:37.587488 [debug] [MainThread]: Using postgres connection "master"
[0m15:50:37.588317 [debug] [MainThread]: On master: BEGIN
[0m15:50:37.827814 [debug] [MainThread]: SQL status: BEGIN in 0.24 seconds
[0m15:50:37.828676 [debug] [MainThread]: On master: COMMIT
[0m15:50:37.829231 [debug] [MainThread]: Using postgres connection "master"
[0m15:50:37.829715 [debug] [MainThread]: On master: COMMIT
[0m15:50:37.951113 [debug] [MainThread]: SQL status: COMMIT in 0.12 seconds
[0m15:50:37.952082 [debug] [MainThread]: On master: Close
[0m15:50:37.953717 [info ] [MainThread]: Concurrency: 4 threads (target='postgres')
[0m15:50:37.954725 [info ] [MainThread]: 
[0m15:50:37.962385 [debug] [Thread-1  ]: Began running node model.hu_dw_datawarehouse.test_table_1
[0m15:50:37.963024 [info ] [Thread-1  ]: 1 of 3 START table model featuredata3405_scratch.test_table_1 .................. [RUN]
[0m15:50:37.963963 [debug] [Thread-1  ]: Acquiring new postgres connection "model.hu_dw_datawarehouse.test_table_1"
[0m15:50:37.964309 [debug] [Thread-1  ]: Began compiling node model.hu_dw_datawarehouse.test_table_1
[0m15:50:37.964622 [debug] [Thread-1  ]: Compiling model.hu_dw_datawarehouse.test_table_1
[0m15:50:37.970513 [debug] [Thread-1  ]: Writing injected SQL for node "model.hu_dw_datawarehouse.test_table_1"
[0m15:50:37.971397 [debug] [Thread-1  ]: finished collecting timing info
[0m15:50:37.971700 [debug] [Thread-1  ]: Began executing node model.hu_dw_datawarehouse.test_table_1
[0m15:50:38.019560 [debug] [Thread-1  ]: Writing runtime SQL for node "model.hu_dw_datawarehouse.test_table_1"
[0m15:50:38.020215 [debug] [Thread-1  ]: Using postgres connection "model.hu_dw_datawarehouse.test_table_1"
[0m15:50:38.020449 [debug] [Thread-1  ]: On model.hu_dw_datawarehouse.test_table_1: BEGIN
[0m15:50:38.020605 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m15:50:39.009373 [debug] [Thread-1  ]: SQL status: BEGIN in 0.99 seconds
[0m15:50:39.010227 [debug] [Thread-1  ]: Using postgres connection "model.hu_dw_datawarehouse.test_table_1"
[0m15:50:39.010777 [debug] [Thread-1  ]: On model.hu_dw_datawarehouse.test_table_1: /* {"app": "dbt", "dbt_version": "1.2.2", "profile_name": "default", "target_name": "postgres", "node_id": "model.hu_dw_datawarehouse.test_table_1"} */


  create  table "defaultdb"."featuredata3405_scratch"."test_table_1__dbt_tmp"
  as (
    

SELECT 
col
, POWER(col,2) AS col_power_2
FROM
"defaultdb"."featuredata3405_scratch"."source_table"
  );
[0m15:50:39.131445 [debug] [Thread-1  ]: SQL status: SELECT 5 in 0.12 seconds
[0m15:50:39.146167 [debug] [Thread-1  ]: Using postgres connection "model.hu_dw_datawarehouse.test_table_1"
[0m15:50:39.146588 [debug] [Thread-1  ]: On model.hu_dw_datawarehouse.test_table_1: /* {"app": "dbt", "dbt_version": "1.2.2", "profile_name": "default", "target_name": "postgres", "node_id": "model.hu_dw_datawarehouse.test_table_1"} */
alter table "defaultdb"."featuredata3405_scratch"."test_table_1" rename to "test_table_1__dbt_backup"
[0m15:50:39.266392 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.12 seconds
[0m15:50:39.274302 [debug] [Thread-1  ]: Using postgres connection "model.hu_dw_datawarehouse.test_table_1"
[0m15:50:39.274759 [debug] [Thread-1  ]: On model.hu_dw_datawarehouse.test_table_1: /* {"app": "dbt", "dbt_version": "1.2.2", "profile_name": "default", "target_name": "postgres", "node_id": "model.hu_dw_datawarehouse.test_table_1"} */
alter table "defaultdb"."featuredata3405_scratch"."test_table_1__dbt_tmp" rename to "test_table_1"
[0m15:50:39.397489 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.12 seconds
[0m15:50:39.420925 [debug] [Thread-1  ]: On model.hu_dw_datawarehouse.test_table_1: COMMIT
[0m15:50:39.434546 [debug] [Thread-1  ]: Using postgres connection "model.hu_dw_datawarehouse.test_table_1"
[0m15:50:39.434925 [debug] [Thread-1  ]: On model.hu_dw_datawarehouse.test_table_1: COMMIT
[0m15:50:39.561631 [debug] [Thread-1  ]: SQL status: COMMIT in 0.13 seconds
[0m15:50:39.566438 [debug] [Thread-1  ]: Using postgres connection "model.hu_dw_datawarehouse.test_table_1"
[0m15:50:39.566676 [debug] [Thread-1  ]: On model.hu_dw_datawarehouse.test_table_1: /* {"app": "dbt", "dbt_version": "1.2.2", "profile_name": "default", "target_name": "postgres", "node_id": "model.hu_dw_datawarehouse.test_table_1"} */
drop table if exists "defaultdb"."featuredata3405_scratch"."test_table_1__dbt_backup" cascade
[0m15:50:39.692712 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.13 seconds
[0m15:50:39.693972 [debug] [Thread-1  ]: finished collecting timing info
[0m15:50:39.694187 [debug] [Thread-1  ]: On model.hu_dw_datawarehouse.test_table_1: Close
[0m15:50:39.694828 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '92205e2d-cef8-45b0-b01c-15ea8e449f8d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff9ff22ce50>]}
[0m15:50:39.695304 [info ] [Thread-1  ]: 1 of 3 OK created table model featuredata3405_scratch.test_table_1 ............. [[32mSELECT 5[0m in 1.73s]
[0m15:50:39.695789 [debug] [Thread-1  ]: Finished running node model.hu_dw_datawarehouse.test_table_1
[0m15:50:39.696591 [debug] [Thread-3  ]: Began running node model.hu_dw_datawarehouse.test_table_2
[0m15:50:39.697127 [info ] [Thread-3  ]: 2 of 3 START table model featuredata3405_scratch.test_table_2 .................. [RUN]
[0m15:50:39.697778 [debug] [Thread-3  ]: Acquiring new postgres connection "model.hu_dw_datawarehouse.test_table_2"
[0m15:50:39.697998 [debug] [Thread-3  ]: Began compiling node model.hu_dw_datawarehouse.test_table_2
[0m15:50:39.698164 [debug] [Thread-3  ]: Compiling model.hu_dw_datawarehouse.test_table_2
[0m15:50:39.701245 [debug] [Thread-3  ]: Writing injected SQL for node "model.hu_dw_datawarehouse.test_table_2"
[0m15:50:39.701982 [debug] [Thread-3  ]: finished collecting timing info
[0m15:50:39.702255 [debug] [Thread-3  ]: Began executing node model.hu_dw_datawarehouse.test_table_2
[0m15:50:39.706749 [debug] [Thread-3  ]: Writing runtime SQL for node "model.hu_dw_datawarehouse.test_table_2"
[0m15:50:39.707404 [debug] [Thread-3  ]: Using postgres connection "model.hu_dw_datawarehouse.test_table_2"
[0m15:50:39.707631 [debug] [Thread-3  ]: On model.hu_dw_datawarehouse.test_table_2: BEGIN
[0m15:50:39.707755 [debug] [Thread-3  ]: Opening a new connection, currently in state init
[0m15:50:40.678066 [debug] [Thread-3  ]: SQL status: BEGIN in 0.97 seconds
[0m15:50:40.678515 [debug] [Thread-3  ]: Using postgres connection "model.hu_dw_datawarehouse.test_table_2"
[0m15:50:40.678824 [debug] [Thread-3  ]: On model.hu_dw_datawarehouse.test_table_2: /* {"app": "dbt", "dbt_version": "1.2.2", "profile_name": "default", "target_name": "postgres", "node_id": "model.hu_dw_datawarehouse.test_table_2"} */


  create  table "defaultdb"."featuredata3405_scratch"."test_table_2__dbt_tmp"
  as (
    

SELECT 
col
, col_power_2
, POWER(col,3) AS col_power_3
, 1/0
FROM
"defaultdb"."featuredata3405_scratch"."test_table_1"
  );
[0m15:50:40.802889 [debug] [Thread-3  ]: Postgres adapter: Postgres error: division by zero

[0m15:50:40.803460 [debug] [Thread-3  ]: On model.hu_dw_datawarehouse.test_table_2: ROLLBACK
[0m15:50:40.922845 [debug] [Thread-3  ]: finished collecting timing info
[0m15:50:40.923665 [debug] [Thread-3  ]: On model.hu_dw_datawarehouse.test_table_2: Close
[0m15:50:40.925286 [debug] [Thread-3  ]: Database Error in model test_table_2 (models/test_table_2.sql)
  division by zero
  compiled SQL at target/run/hu_dw_datawarehouse/models/test_table_2.sql
[0m15:50:40.926194 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '92205e2d-cef8-45b0-b01c-15ea8e449f8d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff9ff2763d0>]}
[0m15:50:40.926993 [error] [Thread-3  ]: 2 of 3 ERROR creating table model featuredata3405_scratch.test_table_2 ......... [[31mERROR[0m in 1.23s]
[0m15:50:40.927962 [debug] [Thread-3  ]: Finished running node model.hu_dw_datawarehouse.test_table_2
[0m15:50:40.929135 [debug] [Thread-2  ]: Began running node model.hu_dw_datawarehouse.test_table_3
[0m15:50:40.929865 [info ] [Thread-2  ]: 3 of 3 SKIP relation featuredata3405_scratch.test_table_3 ...................... [[33mSKIP[0m]
[0m15:50:40.931073 [debug] [Thread-2  ]: Finished running node model.hu_dw_datawarehouse.test_table_3
[0m15:50:40.934255 [debug] [MainThread]: Acquiring new postgres connection "master"
[0m15:50:40.934751 [debug] [MainThread]: Using postgres connection "master"
[0m15:50:40.935062 [debug] [MainThread]: On master: BEGIN
[0m15:50:40.935334 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m15:50:41.920837 [debug] [MainThread]: SQL status: BEGIN in 0.99 seconds
[0m15:50:41.921651 [debug] [MainThread]: On master: COMMIT
[0m15:50:41.922180 [debug] [MainThread]: Using postgres connection "master"
[0m15:50:41.922660 [debug] [MainThread]: On master: COMMIT
[0m15:50:42.042961 [debug] [MainThread]: SQL status: COMMIT in 0.12 seconds
[0m15:50:42.043800 [debug] [MainThread]: On master: Close
[0m15:50:42.045517 [info ] [MainThread]: 
[0m15:50:42.046253 [info ] [MainThread]: Finished running 3 table models in 0 hours 0 minutes and 8.03 seconds (8.03s).
[0m15:50:42.046915 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:50:42.047251 [debug] [MainThread]: Connection 'model.hu_dw_datawarehouse.test_table_1' was properly closed.
[0m15:50:42.047590 [debug] [MainThread]: Connection 'model.hu_dw_datawarehouse.test_table_2' was properly closed.
[0m15:50:42.059211 [info ] [MainThread]: 
[0m15:50:42.059744 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m15:50:42.060212 [info ] [MainThread]: 
[0m15:50:42.060715 [error] [MainThread]: [33mDatabase Error in model test_table_2 (models/test_table_2.sql)[0m
[0m15:50:42.061378 [error] [MainThread]:   division by zero
[0m15:50:42.061865 [error] [MainThread]:   compiled SQL at target/run/hu_dw_datawarehouse/models/test_table_2.sql
[0m15:50:42.062327 [info ] [MainThread]: 
[0m15:50:42.063069 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=1 SKIP=1 TOTAL=3
[0m15:50:42.063775 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff9ff0d25e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff9ff201c70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff9ff2078e0>]}
[0m15:50:42.064177 [debug] [MainThread]: Flushing usage events
